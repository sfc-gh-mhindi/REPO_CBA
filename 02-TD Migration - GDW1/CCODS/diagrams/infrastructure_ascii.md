# Snowflake Infrastructure - ASCII Diagram

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           SNOWFLAKE ENVIRONMENT                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                    NPD_D12_DMN_GDWMIG Database                          │   │
│  │                                                                         │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                        TMP Schema                               │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │   │   │
│  │  │  │ P_EXECUTE_DBT_  │  │ P_EXECUTE_DBT_  │  │    GDW1_DBT     │ │   │   │
│  │  │  │      CSEL       │  │     CCODS       │  │  Shared Project │ │   │   │
│  │  │  │   🔄 18 Steps   │  │   🔄 2 Steps    │  │   📦 Models     │ │   │   │
│  │  │  └─────────────────┘  └─────────────────┘  └─────────────────┘ │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────┐  ┌─────────────────┐                      │   │   │
│  │  │  │ T_EXECUTE_DBT_  │  │ T_EXECUTE_DBT_  │                      │   │   │
│  │  │  │      CSEL       │  │     CCODS       │                      │   │   │
│  │  │  │  ⏰ 3:00 AM     │  │  ⏰ 4:00 AM     │                      │   │   │
│  │  │  └─────────────────┘  └─────────────────┘                      │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                 NPD_D12_DMN_GDWMIG_IBRG_V Database                      │   │
│  │                                                                         │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                   P_V_OUT_001_STD_0 Schema                      │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────┐  ┌─────────────────┐                      │   │   │
│  │  │  │ DCF_T_EXEC_LOG  │  │  RUN_STRM_TMPL  │                      │   │   │
│  │  │  │ 📊 Unified Audit│  │ ⚙️ Control Table│                      │   │   │
│  │  │  │     Table       │  │                 │                      │   │   │
│  │  │  └─────────────────┘  └─────────────────┘                      │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────────────────────────────────────────────────┐   │   │   │
│  │  │  │                Model Outputs                            │   │   │   │
│  │  │  │                                                         │   │   │   │
│  │  │  │  📋 CSEL Models          📈 CCODS Models                │   │   │   │
│  │  │  │  • Appointments          • BCFINSG Transformations      │   │   │   │
│  │  │  │  • Products              • PLAN_BALN_SEGM_MSTR         │   │   │   │
│  │  │  │  • Departments                                          │   │   │   │
│  │  │  └─────────────────────────────────────────────────────────┘   │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        External Systems                                 │   │
│  │                                                                         │   │
│  │  ┌─────────────────┐  ┌─────────────────┐                              │   │
│  │  │   Snowflake     │  │ wh_usr_npd_d12_ │                              │   │
│  │  │ DBT Workspace   │  │  gdwmig_001     │                              │   │
│  │  │                 │  │ Compute Warehouse│                              │   │
│  │  └─────────────────┘  └─────────────────┘                              │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────────┘

Data Flow:
CSEL (3:00 AM) ──► 18 Steps ──► Success ──► 1 Hour Buffer ──► CCODS (4:00 AM) ──► 2 Steps ──► Complete

Monitoring Points:
• DCF_T_EXEC_LOG: Unified audit logging for both processes
• Query History: Real-time execution monitoring  
• DBT Workspace: Model-level status and logs 