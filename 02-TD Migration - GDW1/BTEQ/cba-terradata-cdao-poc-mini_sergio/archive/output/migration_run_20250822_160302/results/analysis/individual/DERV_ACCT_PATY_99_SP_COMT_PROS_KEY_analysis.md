# DERV_ACCT_PATY_99_SP_COMT_PROS_KEY.sql - BTEQ Analysis

## File Overview
- **File Name**: DERV_ACCT_PATY_99_SP_COMT_PROS_KEY.sql
- **Analysis Status**: ‚úÖ Success
- **Control Statements**: 8
- **SQL Blocks**: 1

## Control Flow Analysis

| Line | Type | Statement |
|------|------|-----------|
| 1 | RUN | `.RUN FILE=${ETL_APP_BTEQ}/bteq_login.sql` |
| 2 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 27 | IMPORT | `.IMPORT VARTEXT FILE=/cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_PROS_KEY_DATE....` |
| 47 | EXPORT | `.EXPORT RESET` |
| 49 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 52 | LOGOFF | `.LOGOFF` |
| 54 | LABEL | `.LABEL EXITERR` |
| 56 | LOGOFF | `.LOGOFF` |

## SQL Blocks Analysis

### SQL Block 1 (Lines 33-46)
- **Complexity Score**: 0
- **Has Valid SQL**: ‚úÖ
- **Conversion Successful**: ‚úÖ
- **Syntax Validation**: ‚ùå Invalid
- **Teradata Features**: 0

#### üìù Original Teradata SQL:
```sql
UPDATE STAR_CAD_PROD_DATA.UTIL_PROS_ISAC           
SET
   SUCC_F  = 'Y'
  ,COMT_F = 'Y'
  ,COMT_S = CAST(CAST(current_timestamp as CHAR(20)) as TIMESTAMP(0))
WHERE
  PROS_KEY_I = CAST(trim(:PROSKEY) as DECIMAL(10,0)) 
  AND DERIVED_ACCOUNT_PARTY = 'DERIVED_ACCOUNT_PARTY'
  AND TRGT_M = 'DERV_ACCT_PATY'
  AND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')(CHAR(10))
  
;
```

#### ‚ùÑÔ∏è Converted Snowflake SQL:
```sql
UPDATE STAR_CAD_PROD_DATA.UTIL_PROS_ISAC           
SET
   SUCC_F  = 'Y'
  ,COMT_F = 'Y'
  ,COMT_S = CAST(CAST(current_timestamp as CHAR(20)) as TIMESTAMP(0))
WHERE
  PROS_KEY_I = CAST(trim(:PROSKEY) as DECIMAL(10,0)) 
  AND DERIVED_ACCOUNT_PARTY = 'DERIVED_ACCOUNT_PARTY'
  AND TRGT_M = 'DERV_ACCT_PATY'
  AND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')(CHAR(10))
  
;
```

#### üîç Syntax Validation Details:
- **Valid**: ‚ùå

#### ‚ö° Optimized SQL:
```sql
UPDATE STAR_CAD_PROD_DATA.UTIL_PROS_ISAC           
SET
   SUCC_F  = 'Y'
  ,COMT_F = 'Y'
  ,COMT_S = CAST(CAST(current_timestamp as CHAR(20)) as TIMESTAMP(0))
WHERE
  PROS_KEY_I = CAST(trim(:PROSKEY) as DECIMAL(10,0)) 
  AND DERIVED_ACCOUNT_PARTY = 'DERIVED_ACCOUNT_PARTY'
  AND TRGT_M = 'DERV_ACCT_PATY'
  AND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')(CHAR(10))
  
;
```

#### üìä SQL Metadata:

## Migration Recommendations

### Suggested Migration Strategy
**Simple Model** - Based on complexity score (0) and SQL patterns

### DCF Mapping
- **Error Handling**: Convert `.IF ERRORCODE` patterns to DCF error handling macros
- **File Operations**: Replace IMPORT/EXPORT with dbt seeds or external tables
- **Statistics**: Replace COLLECT STATS with Snowflake post-hooks
- **Stored Procedures**: Map CALL statements to DCF stored procedure macros

---

*Generated by BTEQ Parser Service - 2025-08-22 16:03:08*
