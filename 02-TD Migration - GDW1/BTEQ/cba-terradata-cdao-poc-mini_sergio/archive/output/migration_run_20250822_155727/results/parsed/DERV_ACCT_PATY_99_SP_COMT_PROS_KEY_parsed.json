{
  "sql_blocks": [
    {
      "sql": "UPDATE %%STARDATADB%%.UTIL_PROS_ISAC           \nSET\n   SUCC_F  = 'Y'\n  ,COMT_F = 'Y'\n  ,COMT_S = CAST(CAST(current_timestamp as CHAR(20)) as TIMESTAMP(0))\nWHERE\n  PROS_KEY_I = CAST(trim(:PROSKEY) as DECIMAL(10,0)) \n  AND SRCE_SYST_M = '%%SRCE_M%%'\n  AND TRGT_M = '%%PSST_TABLE_M%%'\n  AND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')(CHAR(10))\n  \n;",
      "start_line": 33,
      "end_line": 46,
      "snowflake_sql": "UPDATE %%STARDATADB%%.UTIL_PROS_ISAC           \nSET\n   SUCC_F  = 'Y'\n  ,COMT_F = 'Y'\n  ,COMT_S = CAST(CAST(current_timestamp as CHAR(20)) as TIMESTAMP(0))\nWHERE\n  PROS_KEY_I = CAST(trim(:PROSKEY) as DECIMAL(10,0)) \n  AND SRCE_SYST_M = '%%SRCE_M%%'\n  AND TRGT_M = '%%PSST_TABLE_M%%'\n  AND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')(CHAR(10))\n  \n;",
      "error": null,
      "metadata": {
        "tables": [],
        "columns": [],
        "functions": [],
        "window_functions": []
      },
      "complexity_metrics": {
        "total_nodes": 0,
        "select_count": 0,
        "join_count": 0,
        "subquery_count": 0,
        "where_conditions": 0,
        "case_statements": 0,
        "window_functions": 0,
        "aggregate_functions": 0
      },
      "teradata_features": [
        "Variable substitution"
      ],
      "syntax_validation": {
        "valid": false,
        "error": "Invalid expression / Unexpected token. Line 10, Col: 61.\n  CE_M%%'\nAND TRGT_M = '%%PSST_TABLE_M%%'\nAND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')\u001b[4m(\u001b[0mCHAR(10))\n;",
        "error_type": "ParseError"
      },
      "optimized_sql": "UPDATE %%STARDATADB%%.UTIL_PROS_ISAC           \nSET\n   SUCC_F  = 'Y'\n  ,COMT_F = 'Y'\n  ,COMT_S = CAST(CAST(current_timestamp as CHAR(20)) as TIMESTAMP(0))\nWHERE\n  PROS_KEY_I = CAST(trim(:PROSKEY) as DECIMAL(10,0)) \n  AND SRCE_SYST_M = '%%SRCE_M%%'\n  AND TRGT_M = '%%PSST_TABLE_M%%'\n  AND BTCH_RUN_D = CAST(:EXTR_D  AS DATE) (FORMAT'YYYY-MM-DD')(CHAR(10))\n  \n;"
    }
  ],
  "controls": [
    {
      "type": "RUN",
      "raw": ".RUN FILE=%%BTEQ_LOGON_SCRIPT%%",
      "args": null,
      "line_no": 1
    },
    {
      "type": "IF_ERRORCODE",
      "raw": ".IF ERRORCODE <> 0    THEN .GOTO EXITERR",
      "args": null,
      "line_no": 2
    },
    {
      "type": "IMPORT",
      "raw": ".IMPORT VARTEXT FILE=/cba_app/CBMGDW/%%ENV_C%%/schedule/%%STRM_C%%_PROS_KEY_DATE.txt",
      "args": null,
      "line_no": 27
    },
    {
      "type": "EXPORT",
      "raw": ".EXPORT RESET",
      "args": null,
      "line_no": 47
    },
    {
      "type": "IF_ERRORCODE",
      "raw": ".IF ERRORCODE <> 0    THEN .GOTO EXITERR",
      "args": null,
      "line_no": 49
    },
    {
      "type": "LOGOFF",
      "raw": ".LOGOFF",
      "args": null,
      "line_no": 52
    },
    {
      "type": "LABEL",
      "raw": ".LABEL EXITERR",
      "args": null,
      "line_no": 54
    },
    {
      "type": "LOGOFF",
      "raw": ".LOGOFF",
      "args": null,
      "line_no": 56
    }
  ],
  "errors": []
}