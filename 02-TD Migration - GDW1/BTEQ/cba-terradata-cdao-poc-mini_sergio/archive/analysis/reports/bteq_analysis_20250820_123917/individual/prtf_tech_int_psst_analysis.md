# prtf_tech_int_psst.sql - BTEQ Analysis

## File Overview
- **File Name**: prtf_tech_int_psst.sql
- **Analysis Status**: ‚úÖ Success
- **Control Statements**: 8
- **SQL Blocks**: 2

## Control Flow Analysis

| Line | Type | Statement |
|------|------|-----------|
| 1 | RUN | `.RUN FILE=%%BTEQ_LOGON_SCRIPT%%` |
| 2 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 39 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 61 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 64 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 68 | LOGOFF | `.LOGOFF` |
| 70 | LABEL | `.LABEL EXITERR` |
| 72 | LOGOFF | `.LOGOFF` |

## SQL Blocks Analysis

### SQL Block 1 (Lines 30-38)
- **Complexity Score**: 38
- **Has Valid SQL**: ‚úÖ
- **Conversion Successful**: ‚úÖ
- **Syntax Validation**: ‚úÖ Valid
- **Teradata Features**: 1

#### üìù Original Teradata SQL:
```sql
Delete
	A
From 
	 %%STARDATADB%%.DERV_PRTF_INT_PSST A
	,%%VTECH%%.DERV_PRTF_INT_HIST_PSST B
Where  
  A.INT_GRUP_I = B.INT_GRUP_I
  And (A.JOIN_FROM_D,A.JOIN_TO_D) overlaps (B.JOIN_FROM_D,B.JOIN_TO_D)   
;
```

#### ‚ùÑÔ∏è Converted Snowflake SQL:
```sql
DELETE A FROM %%STARDATADB%%.DERV_PRTF_INT_PSST AS A, %%VTECH%%.DERV_PRTF_INT_HIST_PSST AS B WHERE A.INT_GRUP_I = B.INT_GRUP_I AND (A.JOIN_FROM_D, A.JOIN_TO_D) OVERLAPS (B.JOIN_FROM_D, B.JOIN_TO_D)
```

#### üîç Syntax Validation Details:
- **Valid**: ‚úÖ

#### üéØ Teradata Features Detected:
- Variable substitution

#### ‚ö° Optimized SQL:
```sql
DELETE   "a" FROM "%%stardatadb%%"."derv_prtf_int_psst" AS "a"
  CROSS JOIN "%%vtech%%"."derv_prtf_int_hist_psst" AS "b"
WHERE
  "a"."int_grup_i" = "b"."int_grup_i"
  AND ("a"."join_from_d", "a"."join_to_d") OVERLAPS ("b"."join_from_d", "b"."join_to_d")
```

#### üìä SQL Metadata:
- **Tables**: A, DERV_PRTF_INT_HIST_PSST, DERV_PRTF_INT_PSST
- **Columns**: INT_GRUP_I, JOIN_FROM_D, JOIN_TO_D
- **Functions**: A.INT_GRUP_I = B.INT_GRUP_I

### SQL Block 2 (Lines 45-60)
- **Complexity Score**: 44
- **Has Valid SQL**: ‚úÖ
- **Conversion Successful**: ‚úÖ
- **Syntax Validation**: ‚úÖ Valid
- **Teradata Features**: 1

#### üìù Original Teradata SQL:
```sql
Insert into %%STARDATADB%%.DERV_PRTF_INT_PSST
Select
   A.INT_GRUP_I                    
  ,A.INT_GRUP_TYPE_C               
  ,A.JOIN_FROM_D                   
  ,A.JOIN_TO_D    
  ,A.EFFT_D
  ,A.EXPY_D                 
  ,A.PTCL_N                        
  ,A.REL_MNGE_I                    
  ,A.VALD_FROM_D                   
  ,A.VALD_TO_D          
  ,0 as PROS_KEY_I         
From 
  %%VTECH%%.DERV_PRTF_INT_HIST_PSST A
;
```

#### ‚ùÑÔ∏è Converted Snowflake SQL:
```sql
INSERT INTO %%STARDATADB%%.DERV_PRTF_INT_PSST SELECT A.INT_GRUP_I, A.INT_GRUP_TYPE_C, A.JOIN_FROM_D, A.JOIN_TO_D, A.EFFT_D, A.EXPY_D, A.PTCL_N, A.REL_MNGE_I, A.VALD_FROM_D, A.VALD_TO_D, 0 AS PROS_KEY_I FROM %%VTECH%%.DERV_PRTF_INT_HIST_PSST AS A
```

#### üîç Syntax Validation Details:
- **Valid**: ‚úÖ

#### üéØ Teradata Features Detected:
- Variable substitution

#### ‚ö° Optimized SQL:
```sql
INSERT INTO "%%stardatadb%%"."derv_prtf_int_psst"
SELECT
  "a"."int_grup_i" AS "int_grup_i",
  "a"."int_grup_type_c" AS "int_grup_type_c",
  "a"."join_from_d" AS "join_from_d",
  "a"."join_to_d" AS "join_to_d",
  "a"."efft_d" AS "efft_d",
  "a"."expy_d" AS "expy_d",
  "a"."ptcl_n" AS "ptcl_n",
  "a"."rel_mnge_i" AS "rel_mnge_i",
  "a"."vald_from_d" AS "vald_from_d",
  "a"."vald_to_d" AS "vald_to_d",
  0 AS "pros_key_i"
FROM "%%vtech%%"."derv_prtf_int_hist_psst" AS "a"
```

#### üìä SQL Metadata:
- **Tables**: DERV_PRTF_INT_HIST_PSST, DERV_PRTF_INT_PSST
- **Columns**: EFFT_D, EXPY_D, INT_GRUP_I, INT_GRUP_TYPE_C, JOIN_FROM_D, JOIN_TO_D, PTCL_N, REL_MNGE_I, VALD_FROM_D, VALD_TO_D

## Migration Recommendations

### Suggested Migration Strategy
**Medium complexity** - Incremental model with DCF hooks recommended

### DCF Mapping
- **Error Handling**: Convert `.IF ERRORCODE` patterns to DCF error handling macros
- **File Operations**: Replace IMPORT/EXPORT with dbt seeds or external tables
- **Statistics**: Replace COLLECT STATS with Snowflake post-hooks
- **Stored Procedures**: Map CALL statements to DCF stored procedure macros

---

*Generated by BTEQ Parser Service - 2025-08-20 12:39:23*
