/*** SSC-OOS-0001 - OUT OF SCOPE FILE â€“ FILE NOT PARSED DUE TO UNEXPECTED ENCODING. CHECK THE ERROR LOG FOR MORE INFORMATION. ***/
-- .RUN FILE=%%BTEQ_LOGON_SCRIPT%%

-- .IF ERRORLEVEL <> 0 THEN .GOTO EXITERR

-- .SET QUIET OFF
-- .SET ECHOREQ ON
-- .SET FORMAT OFF
-- .SET WIDTH 120

-- ------------------------------------------------------------------------------
-- -- Object Name             :  DERV_ACCT_PATY_02_CRAT_WORK_TABL.sql
-- -- Object Type             :  BTEQ

-- --                           
-- -- Description             :  Create work/staging tables that will be used in this stream  
-- --                          
-- ------------------------------------------------------------------------------
-- -- Modification History
-- -- Date               Author           Version     Version Description
-- -- 04/06/2013         Helen Zak        1.0         Initial Version
-- -- 07/08/2013         Helen Zak        1.1         C0714578 - post-implementation fixes 
-- --                                                 Add missing grant index on DERV_ACCT_PATY_RM  
-- --                                                 Create 3 tables for persisting GRD views and populate them
-- -- 18/08/2013         Helen Zak        1.2         C0726912 - post-implementation fix
-- --                                                 more working tables and remove redundant tables
-- -- 28/08/2013         Helen Zak        1.3         C0733426
-- --                                                 more working tables and more grants 
-- -- 02/09/2013         Helen Zak        1.4         C0737261
-- --                                                 more working tables and more grants 
-- --                                                 and remove redundant tables and grants 
-- -- 11/09/2013        Helen Zak        1.5          C0746488 
-- --                                                 New work table to syncronise ROW_SECU_ACCS_C
-- --                                                 with ACCT_PATY   
-- -- 25/08/2016        A&IPlatformRRTSquad@cba.com.au
-- --				      1.6          C2039845
-- --                                                 DERV_ACCT_PATY PRTF_PATY_F Update for FUND HOLDER     
-- ------------------------------------------------------------------------------

-- -- Drop all work tables just in case. 


-- DROP TABLE %%DDSTG%%.ACCT_PATY_REL_THA;

-- .IF ERRORCODE = 3807 THEN .GOTO NEXT1
-- .IF ERRORCODE = 0    THEN .GOTO NEXT1
-- .QUIT ERRORCODE

-- .LABEL NEXT1

-- DROP TABLE %%DDSTG%%.ACCT_PATY_THA_NEW_RNGE;

-- .IF ERRORCODE = 3807 THEN .GOTO NEXT2
-- .IF ERRORCODE = 0    THEN .GOTO NEXT2
-- .QUIT ERRORCODE

-- .LABEL NEXT2



-- DROP TABLE %%DDSTG%%.DERV_ACCT_PATY_CURR;

-- .IF ERRORCODE = 3807 THEN .GOTO NEXT3
-- .IF ERRORCODE = 0    THEN .GOTO NEXT3
-- .QUIT ERRORCODE

-- .LABEL NEXT3

-- DROP TABLE %%DDSTG%%.DERV_PRTF_ACCT_STAG;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT4
-- .IF ERRORCODE = 0    THEN .GOTO NEXT4
-- .QUIT ERRORCODE

-- .LABEL NEXT4

-- DROP TABLE %%DDSTG%%.DERV_PRTF_PATY_STAG;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT5
-- .IF ERRORCODE = 0    THEN .GOTO NEXT5
-- .QUIT ERRORCODE

-- .LABEL NEXT5

-- DROP TABLE %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT6
-- .IF ERRORCODE = 0    THEN .GOTO NEXT6
-- .QUIT ERRORCODE

-- .LABEL NEXT6


-- DROP  TABLE %%DDSTG%%.DERV_ACCT_PATY_RM;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT7
-- .IF ERRORCODE = 0    THEN .GOTO NEXT7
-- .QUIT ERRORCODE

-- .LABEL NEXT7



-- DROP TABLE %%DDSTG%%.DERV_ACCT_PATY_ADD;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT8
-- .IF ERRORCODE = 0    THEN .GOTO NEXT8
-- .QUIT ERRORCODE

-- .LABEL NEXT8

-- DROP TABLE %%DDSTG%%.DERV_ACCT_PATY_CHG;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT9
-- .IF ERRORCODE = 0    THEN .GOTO NEXT9
-- .QUIT ERRORCODE

-- .LABEL NEXT9

-- DROP TABLE %%DDSTG%%.DERV_ACCT_PATY_FLAG;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT10
-- .IF ERRORCODE = 0    THEN .GOTO NEXT10
-- .QUIT ERRORCODE

-- .LABEL NEXT10


-- DROP TABLE %%DDSTG%%.ACCT_PATY_REL_WSS;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT11
-- .IF ERRORCODE = 0    THEN .GOTO NEXT11
-- .QUIT ERRORCODE

-- .LABEL NEXT11


-- DROP TABLE %%DDSTG%%.ACCT_REL_WSS_DITPS;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT12
-- .IF ERRORCODE = 0    THEN .GOTO NEXT12
-- .QUIT ERRORCODE

-- .LABEL NEXT12




-- DROP TABLE %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_HOLD;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT13
-- .IF ERRORCODE = 0    THEN .GOTO NEXT13
-- .QUIT ERRORCODE

-- .LABEL NEXT13

-- DROP TABLE %%DDSTG%%.GRD_GNRC_MAP_DERV_UNID_PATY;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT14
-- .IF ERRORCODE = 0    THEN .GOTO NEXT14
-- .QUIT ERRORCODE

-- .LABEL NEXT14

-- DROP TABLE %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_REL;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT15
-- .IF ERRORCODE = 0    THEN .GOTO NEXT15
-- .QUIT ERRORCODE

-- .LABEL NEXT15

-- DROP TABLE %%DDSTG%%.DERV_ACCT_PATY_DEL;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT16
-- .IF ERRORCODE = 0    THEN .GOTO NEXT16
-- .QUIT ERRORCODE

-- .LABEL NEXT16


-- DROP TABLE %%DDSTG%%.ACCT_PATY_DEDUP;

-- .IF ERRORCODE = 3807 THEN .GOTO NEXT17
-- .IF ERRORCODE = 0    THEN .GOTO NEXT17
-- .QUIT ERRORCODE

-- .LABEL NEXT17

-- DROP TABLE %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST;

-- .IF ERRORCODE = 3807 THEN .GOTO NEXT18
-- .IF ERRORCODE = 0    THEN .GOTO NEXT18
-- .QUIT ERRORCODE

-- .LABEL NEXT18

-- DROP  TABLE %%DDSTG%%.DERV_ACCT_PATY_NON_RM;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT19
-- .IF ERRORCODE = 0    THEN .GOTO NEXT19
-- .QUIT ERRORCODE

-- .LABEL NEXT19

-- DROP  TABLE %%DDSTG%%.DERV_ACCT_PATY_ROW_SECU_FIX;
-- .IF ERRORCODE = 3807 THEN .GOTO NEXT20
-- .IF ERRORCODE = 0    THEN .GOTO NEXT20
-- .QUIT ERRORCODE

-- .LABEL NEXT20
-- 	
-- ---- 1. Create new Staging Table %%DDSTG%%.ACCT_PATY_THA_NEW_RNGE 

-- CREATE SET TABLE %%DDSTG%%.ACCT_PATY_THA_NEW_RNGE ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       THA_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Thaler Account Identifier' NOT NULL,
--       TRAD_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Trading Account Identifier' NOT NULL,
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
--       NEW_EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'New Expiry Date')
-- PRIMARY INDEX ( TRAD_ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- --Collect Initial Statistics on the new staging table

-- COLLECT STATS ON %%DDSTG%%.ACCT_PATY_THA_NEW_RNGE INDEX(TRAD_ACCT_I);
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- ----2. Create new Staging Table %%DDSTG%%.ACCT_PATY_REL_THA 

-- CREATE MULTISET TABLE %%DDSTG%%.ACCT_PATY_REL_THA ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       THA_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Thaler Account Identifier' NOT NULL,
--       TRAD_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Trading Account Identifier' NOT NULL,
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL)
-- PRIMARY INDEX ( TRAD_ACCT_I );

-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- --Collect Initial Statistics on the new staging table

-- COLLECT STATS ON %%DDSTG%%.ACCT_PATY_REL_THA INDEX(TRAD_ACCT_I);
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 





-- ----3. Create new Table %%DDSTG%%.DERV_ACCT_PATY_CURR

-- CREATE SET TABLE %%DDSTG%%.DERV_ACCT_PATY_CURR ,NO FALLBACK ,
-- 	     NO BEFORE JOURNAL,
-- 	     NO AFTER JOURNAL,
-- 	     CHECKSUM = DEFAULT
-- 	     (
-- 	      ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
-- 	      PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
-- 	      ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
-- 	      PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
-- 	      COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
-- 	      PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
-- 	      SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
-- 	      EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
-- 	      EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
-- 	      ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0 
-- 	      )
-- 	PRIMARY INDEX ( ACCT_I )
-- 	INDEX ( ASSC_ACCT_I )
-- 	INDEX ( PATY_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CURR INDEX ( ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CURR INDEX ( ASSC_ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CURR INDEX ( PATY_I );
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
--   
--    COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CURR COLUMN EFFT_D;
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
--    
--     COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CURR COLUMN EXPY_D;
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

--  COLLECT  STATS %%DDSTG%%.DERV_ACCT_PATY_CURR  COLUMN PATY_ACCT_REL_C;
--   .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
--   
-- ----4. Create new Staging Table %%DDSTG%%.DERV_PRTF_ACCT_STAG

-- CREATE MULTISET TABLE %%DDSTG%%.DERV_PRTF_ACCT_STAG ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier',
--       PRTF_CODE_X VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Derived Portfolio Code')
-- PRIMARY INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS %%DDSTG%%.DERV_PRTF_ACCT_STAG INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- COLLECT STATISTICS %%DDSTG%%.DERV_PRTF_ACCT_STAG COLUMN PRTF_CODE_X;
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- ----5. Create new Staging Table %%DDSTG%%.DERV_PRTF_PATY_STAG

-- CREATE MULTISET TABLE %%DDSTG%%.DERV_PRTF_PATY_STAG ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier',
--       PRTF_CODE_X VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Derived Portfolio Code')
-- PRIMARY INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS %%DDSTG%%.DERV_PRTF_PATY_STAG INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATISTICS %%DDSTG%%.DERV_PRTF_PATY_STAG COLUMN PRTF_CODE_X;
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- ----6. Create new Staging Table %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG

-- CREATE SET TABLE %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier', 
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier',
--       ACCT_PRTF_C VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Portfolio Code',
--       PATY_PRTF_C VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Portfolio Code',
-- 	  PATY_ACCT_REL_C CHAR(6)  TITLE 'Paty Account Relationship', /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder  Change  */			   
--       RANK_I INTEGER  TITLE 'RANK'		   /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder  Change  */      

--        )
-- PRIMARY INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- COLLECT STATS %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- ----7. Create new Table %%DDSTG%%.DERV_ACCT_PATY_RM

-- CREATE MULTISET TABLE %%DDSTG%%.DERV_ACCT_PATY_RM ,NO FALLBACK ,
-- 	     NO BEFORE JOURNAL,
-- 	     NO AFTER JOURNAL,
-- 	     CHECKSUM = DEFAULT
-- 	     (
-- 	      ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
-- 	      PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
-- 	      ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
-- 	      PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
-- 	      COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
-- 	      PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
-- 	      SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
-- 	      EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
-- 	      EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
-- 	      ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0
-- 	      )
-- 	PRIMARY INDEX ( ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_RM INDEX ( ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_RM COLUMN PATY_I;
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_RM COLUMN PATY_ACCT_REL_C;
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- ----8. Create new Table %%DDSTG%%.DERV_ACCT_PATY_NON_RM

-- CREATE MULTISET TABLE %%DDSTG%%.DERV_ACCT_PATY_NON_RM ,NO FALLBACK ,
-- 	     NO BEFORE JOURNAL,
-- 	     NO AFTER JOURNAL,
-- 	     CHECKSUM = DEFAULT
-- 	     (
-- 	      ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
-- 	      PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
-- 	      ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
-- 	      PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
-- 	      COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
-- 	      PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
-- 	      SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
-- 	      EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
-- 	      EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
-- 	      ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0,
-- 		  RANK_I INTEGER       /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder  Change  */

-- 	      )
-- 	PRIMARY INDEX ( ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_NON_RM INDEX ( ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 	

--      COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_NON_RM COLUMN PATY_I;
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_NON_RM COLUMN PATY_ACCT_REL_C;
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- ----9. Create new Table %%DDSTG%%.DERV_ACCT_PATY_FLAG

-- CREATE SET TABLE %%DDSTG%%.DERV_ACCT_PATY_FLAG ,NO FALLBACK ,
-- 	     NO BEFORE JOURNAL,
-- 	     NO AFTER JOURNAL,
-- 	     CHECKSUM = DEFAULT
-- 	     (
-- 	      ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
-- 	      PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
-- 	      ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
-- 	      PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
-- 	      COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
-- 	      PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
-- 	      SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
-- 	      EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
-- 	      EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
-- 	      ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0
-- 	      )
-- 	PRIMARY INDEX ( ACCT_I ); 
-- 	
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_FLAG INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
-- 	
-- ----10. Create new Table %%DDSTG%%.DERV_ACCT_PATY_ADD


-- CREATE MULTISET TABLE %%DDSTG%%.DERV_ACCT_PATY_ADD ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
--       ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
--       PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
--       COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
--       PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
--       SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
--       ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0)
-- PRIMARY INDEX ( ACCT_I )
-- INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_ADD  INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_ADD  INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- ----11. Create new Table %%DDSTG%%.DERV_ACCT_PATY_CHG


-- CREATE MULTISET TABLE %%DDSTG%%.DERV_ACCT_PATY_CHG ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
--       ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
--       PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
--       COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
--       PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
--       SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
--       
--       ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0)
-- PRIMARY INDEX ( ACCT_I )
-- INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CHG  INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_CHG  INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- ----12. Create new Table %%DDSTG%%.DERV_ACCT_PATY_DEL

-- CREATE MULTISET TABLE %%DDSTG%%.DERV_ACCT_PATY_DEL ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
--       ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
--       PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
--       COMPRESS ('DEL   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
--       PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
--       SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
--       ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0)
-- PRIMARY INDEX ( ACCT_I )
-- INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_DEL  INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_DEL  INDEX ( PATY_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- ----13. Create new Table %%DDSTG%%.ACCT_PATY_REL_WSS

-- CREATE MULTISET TABLE %%DDSTG%%.ACCT_PATY_REL_WSS ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
--       ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
--       PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
--       COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
--       PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
--       SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
--       ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0 )
-- PRIMARY INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- COMMENT ON TABLE %%DDSTG%%.ACCT_PATY_REL_WSS
-- 'DERV_ACCT_PATY ï¿½ work table for WSS accounts';
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS ON %%DDSTG%%.ACCT_PATY_REL_WSS INDEX(ACCT_I);
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- ----14. Create new Table %%DDSTG%%.ACCT_PATY_WSS_DITPS

-- CREATE SET TABLE %%DDSTG%%.ACCT_REL_WSS_DITPS ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'ACCOUNT IDENTIFIER' NOT NULL)
-- PRIMARY INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

-- COLLECT STATS %%DDSTG%%.ACCT_REL_WSS_DITPS INDEX(ACCT_I);
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- ----15. Create new Table %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_HOLD

-- CREATE SET TABLE %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_HOLD ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       MAP_TYPE_C VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'MAPPING TYPE CODE' NOT NULL,
--       PATY_ACCT_REL_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Party Relationship Code',
--       PATY_ACCT_REL_X  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Party Relationship Code Description',
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'EFFECTIVE DATE' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'EXPIRY DATE' NOT NULL DEFAULT DATE '9999-12-31')
--  PRIMARY INDEX ( PATY_ACCT_REL_C );
--  .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  COLLECT STATS %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_HOLD INDEX ( PATY_ACCT_REL_C );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  INSERT INTO %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_HOLD
--  SELECT MAP_TYPE_C
--                ,PATY_ACCT_REL_C
--                ,PATY_ACCT_REL_X
--                ,EFFT_D
--                ,EXPY_D
--       FROM  %%VTECH%%.GRD_GNRC_MAP_DERV_PATY_HOLD; 
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR  
--  

--   COLLECT STATS %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_HOLD;  
--   .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  ----16. Create new Table %%DDSTG%%.GRD_GNRC_MAP_DERV_UNID_PATY
--   
--   CREATE SET TABLE %%DDSTG%%.GRD_GNRC_MAP_DERV_UNID_PATY ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       MAP_TYPE_C VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'MAPPING TYPE CODE' NOT NULL,
--       SRCE_SYST_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code',
--       UNID_PATY_SRCE_SYST_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Unidentified Party Source System Code',
--       UNID_PATY_ACCT_REL_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Unidentified Party Account Relationship Code',
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'EFFECTIVE DATE' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'EXPIRY DATE' NOT NULL DEFAULT DATE '9999-12-31')
--  PRIMARY INDEX ( SRCE_SYST_C );
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  COLLECT STATS %%DDSTG%%.GRD_GNRC_MAP_DERV_UNID_PATY INDEX ( SRCE_SYST_C );
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  INSERT INTO %%DDSTG%%.GRD_GNRC_MAP_DERV_UNID_PATY
--  SELECT MAP_TYPE_C
--                ,SRCE_SYST_C
--                ,UNID_PATY_SRCE_SYST_C
--                ,UNID_PATY_ACCT_REL_C
--                ,EFFT_D
--                ,EXPY_D
--       FROM   %%VTECH%%.GRD_GNRC_MAP_DERV_UNID_PATY;   
--   .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--         
--  COLLECT STATS %%DDSTG%%.GRD_GNRC_MAP_DERV_UNID_PATY;    
--   .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--   
--  ----17. Create new Table %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_REL
--   
--   CREATE SET TABLE %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_REL ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       MAP_TYPE_C VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'MAPPING TYPE CODE' NOT NULL,
--       SRCE_SYST_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code',
--       REL_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Relationship Code',
--       ACCT_I_C  VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Code',
--       EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'EFFECTIVE DATE' NOT NULL,
--       EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'EXPIRY DATE' NOT NULL DEFAULT DATE '9999-12-31')
--  PRIMARY INDEX ( REL_C );
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  COLLECT STATS %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_REL INDEX ( REL_C );
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--  
--  INSERT INTO %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_REL
--  SELECT MAP_TYPE_C
--                ,SRCE_SYST_C
--                ,REL_C
--                ,ACCT_I_C
--                ,EFFT_D
--                ,EXPY_D
--       FROM   %%VTECH%%.GRD_GNRC_MAP_DERV_PATY_REL;   
--         .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--  COLLECT STATS %%DDSTG%%.GRD_GNRC_MAP_DERV_PATY_REL;   
--    .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


-- ---- 18.Create new Table %%DDSTG%%.ACCT_PATY_DEDUP

-- CREATE SET TABLE %%DDSTG%%.ACCT_PATY_DEDUP ,NO FALLBACK ,
-- 	     NO BEFORE JOURNAL,
-- 	     NO AFTER JOURNAL,
-- 	     CHECKSUM = DEFAULT
-- 	     (
-- 	      ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
-- 	      PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier' NOT NULL,
-- 	      ASSC_ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Associated Account Identifier' NOT NULL,
-- 	      PATY_ACCT_REL_C CHAR(6) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Account Relationship Code' NOT NULL 
-- 	      COMPRESS ('ADD   ','BCA010','BCA030','COO   ','PRI   ','SOL   ','ZBCA10','ZINTE0'),  /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder Change  */
-- 	      PRFR_PATY_F CHAR(1) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Preferred Party Flag' COMPRESS ('N','Y'),
-- 	      SRCE_SYST_C CHAR(3) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Source System Code' COMPRESS ('CIF','SAP'),
-- 	      EFFT_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Effective Date' NOT NULL,
-- 	      EXPY_D DATE FORMAT 'YYYY-MM-DD' TITLE 'Expiry Date' NOT NULL,
-- 	      ROW_SECU_ACCS_C INTEGER TITLE 'ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0 
-- 	      )
-- 	PRIMARY INDEX ( ACCT_I )
-- 	;
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- 	COLLECT STATS %%DDSTG%%.ACCT_PATY_DEDUP INDEX ( ACCT_I );
-- 	.IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
-- 	
-- ----19. Create new Table %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST

-- CREATE SET TABLE %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier',
--       PATY_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Party Identifier',
--       ACCT_PRTF_C VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Portfolio Code',
-- 	  RANK_I INTEGER,             /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder  Change  */
-- 	  PATY_ACCT_REL_C CHAR(6)   /* C2039849 _IM1317265_ Revenue_Attribution_to_Fund_Holder  Change  */	
--       )
-- PRIMARY INDEX ( ACCT_I )
-- INDEX(PATY_I);
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- COLLECT STATS %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST INDEX ( ACCT_I );	
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- COLLECT STATS %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST INDEX ( PATY_I );	
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- COLLECT STATS %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST COLUMN ACCT_PRTF_C;	
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 
--    
-- ----20. Create new Table %%DDSTG%%.DERV_PRTF_ACCT_PATY_ROW_SECU_FIX

-- CREATE MULTISET TABLE %%DDSTG%%.DERV_ACCT_PATY_ROW_SECU_FIX ,NO FALLBACK ,
--      NO BEFORE JOURNAL,
--      NO AFTER JOURNAL,
--      CHECKSUM = DEFAULT
--      (
--       ACCT_I VARCHAR(255) CHARACTER SET LATIN NOT CASESPECIFIC TITLE 'Account Identifier' NOT NULL,
--       DERV_ACCT_PATY_ROW_SECU_ACCS_C INTEGER TITLE 'DERV ACCT_PATY ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0,
--       ACCT_PATY_ROW_SECU_ACCS_C INTEGER TITLE 'ACCT_PATY ROW SECURITY ACCESS CODE' NOT NULL DEFAULT 0  COMPRESS 0 )
-- PRIMARY INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

-- COLLECT STATS %%DDSTG%%.DERV_ACCT_PATY_ROW_SECU_FIX INDEX ( ACCT_I );
-- .IF ERRORCODE   <> 0 THEN .GOTO EXITERR 

--    
-- -- Grant accesses to the tables that have just been created to the users that will access them
-- -- Grant INDEX access to individual tables

--       GRANT INDEX ON %%DDSTG%%.DERV_PRTF_ACCT_STAG TO %%UCB%%2220;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--       GRANT INDEX ON %%DDSTG%%.DERV_PRTF_PATY_STAG TO %%UCB%%2220;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       GRANT INDEX ON %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG TO %%UCB%%2220;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR

--       GRANT INDEX ON %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG TO %%UCB%%2221;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--     
--      GRANT INDEX ON %%DDSTG%%.ACCT_PATY_REL_WSS TO %%UCB%%2221;
--      .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--      GRANT INDEX ON %%DDSTG%%.ACCT_REL_WSS_DITPS TO %%UCB%%2221;
--      .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--      GRANT INDEX ON %%DDSTG%%.ACCT_PATY_REL_WSS TO %%UCB%%2221;
--      .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--     
--      GRANT INDEX ON %%DDSTG%%.ACCT_PATY_REL_THA TO %%UCB%%2221;
--      .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--     GRANT INDEX ON %%DDSTG%%.ACCT_PATY_THA_NEW_RNGE TO %%UCB%%2221;
--     .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--     GRANT INDEX ON %%DDSTG%%.ACCT_PATY_THA_NEW_RNGE TO %%UCB%%2221;
--     .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--     GRANT INDEX ON %%DDSTG%%.ACCT_PATY_REL_THA TO %%UCB%%2221;
--     .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--     GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_CURR TO %%UCB%%2221;
--     .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--      GRANT INDEX ON %%DDSTG%%.ACCT_PATY_DEDUP TO %%UCB%%2221;
--     .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--    
--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_RM TO %%UCB%%2222;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--      
--       GRANT INDEX ON %%DDSTG%%.DERV_PRTF_ACCT_PATY_STAG TO %%UCB%%2222;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--    
--       GRANT INDEX ON %%DDSTG%%.DERV_PRTF_ACCT_PATY_PSST TO %%UCB%%2222;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--    
--      
--     
--      GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_NON_RM TO %%UCB%%2223;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_FLAG TO %%UCB%%2223;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR


--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_ADD TO %%UCB%%2224;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_CHG TO %%UCB%%2224;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_DEL TO %%UCB%%2224;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_ADD TO %%UCB%%2225;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_CHG TO %%UCB%%2225;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--        GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_DEL TO %%UCB%%2225;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
--        GRANT INDEX ON %%DDSTG%%.DERV_ACCT_PATY_ROW_SECU_FIX TO %%UCB%%2225;
--       .IF ERRORCODE   <> 0 THEN .GOTO EXITERR
--       
-- .QUIT 0

-- -- $LastChangedBy: zakhe $
-- -- $LastChangedDate: 2013-09-11 15:36:32 +1000 (Wed, 11 Sep 2013) $
-- -- $LastChangedRevision: 12624 $

-- .LABEL EXITERR
-- .QUIT 4
