!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.RUN FILE=%%BTEQ_LOGON_SCRIPT%%

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.SET QUIET OFF

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.SET ECHOREQ ON

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.SET FORMAT OFF

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.SET WIDTH 120

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '15' COLUMN '0' OF THE SOURCE CODE STARTING AT 'CREATE'. EXPECTED 'Create table Statement' GRAMMAR. LAST MATCHING TOKEN WAS 'JOIN' ON LINE '49' COLUMN '7'. **
--------------------------------------------------------------------------------
---- Object Name             :  BTEQ_SAP_EDO_WKLY_LOAD.sql
---- Object Type             :  BTEQ                
---- Description             :  to load the missing accounts
--------------------------------------------------------------------------------

--CREATE MULTISET VOLATILE TABLE XUJE_OFFSET_MC_RPT_1710
-- AS
--(
--SEL
--OPEN_MC.INTR_CNCT_NUMB_OF_MAIN_CNCT AS OFFSET_MC_ID,
--OPEN_MC.MSTR_CNCT_NUMB AS OFFSET_MC_NUMBER,
--OPEN_MC.SALE_PDCT,
--OPEN_MC.LOAD_S AS MCDMG_LOAD_S,
--CASE WHEN C.CTCT_STUS = '30' THEN 'OPEN' ELSE 'CLOSED' END AS PACKAGE_STATUS,
--CASE WHEN C.CTCT_STUS = '50' THEN C.VALD_FROM ELSE NULL END AS CLOSURE_DATE ,
--E.EXTL_CNCT_PART_1 AS PARTICIPATE_ACCOUNT_ID,
--CASE WHEN  E.CNCT_TYPE_KEY = '5' THEN F.BANK END AS PARTICIPATE_ACCOUNT_BSB,
--CASE WHEN  E.CNCT_TYPE_KEY = '6'  AND E.NON_SAP_ACCT_NUMB IS NOT NULL THEN NON_SAP_ACCT_NUMB
--WHEN  E.CNCT_TYPE_KEY = '5'  AND EXTL_CNCT_PART_1 IS NOT NULL THEN F.EXTL_ACCT_NUMB  END AS PARTICIPATE_ACCOUNT_NUMBER,
--CAST(E.CIF_PDCT_IDNN AS DECIMAL(4,0)) as Prxy_PDCT_IDNN,
--CASE WHEN E.CNCT_TYPE_KEY = '5' THEN 'SAP' ELSE  E.SRCE_SYST  END AS PARTICIPATE_ACCOUNT_SOURCE,
--CASE WHEN E.NON_SAP_ACCT_SALE_PDCT IS NOT NULL THEN NON_SAP_ACCT_SALE_PDCT ELSE F.SALE_PDCT END AS PARTICIPATE_ACCOUNT_SP,
--E.LOAD_S AS PRXY_LOAD_S,
--CASE WHEN F.ACCT_STUS = '30' THEN 'OPEN' WHEN F.ACCT_STUS  IS NULL AND G.ACCT_CLSE_DATE ='9999-12-31' THEN 'OPEN' ELSE 'CLOSED' END AS ACCT_STATUS,
--G.PDCT_IDNN as Wul_pdct,
--G.LOAD_S AS WNSA_LOAD_S,
--P.SALES_PRODUCT_DESC AS PARTICIPATE_ACCOUNT_SP_DESCRIPTION,
--CAST(D.VALD_FROM AS DATE) AS DATE_OF_LINKAGE,
--CAST(D.ACTL_VALD_END AS DATE) AS EXPIRE_OF_LINKAGE
--,D.LOAD_S AS MCB_LOAD_S

--FROM
--( SEL B.INTR_CNCT_NUMB_OF_MAIN_CNCT, B.MSTR_CNCT_NUMB, B.LOAD_S,A.SALE_PDCT,C.LOAD_S AS CNCT_LOAD_S FROM  %%VCBODS%%.CBA_FNCL_SERV_GL_DATA_CURR A
--INNER JOIN  %%VCBODS%%.MSTR_CNCT_MSTR_DATA_GENL_CURR B ON  A.INTR_CNCT_ID = B.INTR_CNCT_NUMB_OF_MAIN_CNCT
--INNER JOIN  %%VCBODS%%.CNCT_HEAD C ON C.CNCT = B.INTR_CNCT_NUMB_OF_MAIN_CNCT
--WHERE A.SALE_PDCT = '001603' AND A.SRCE_SYST_ISAC_CODE = 'E001' AND B.SRCE_SYST_ISAC_CODE = 'E001' AND C.SRCE_SYST_ISAC_CODE = 'E001'
--QUALIFY  RANK() OVER (PARTITION BY  C.CNCT ORDER BY C.LOAD_S DESC, C.VALD_FROM DESC)= 1
--) AS OPEN_MC

--INNER JOIN  %%VCBODS%%.CNCT_HEAD_CURR C ON C.CNCT = OPEN_MC.INTR_CNCT_NUMB_OF_MAIN_CNCT

--LEFT OUTER JOIN
--(
--SEL * FROM  %%VCBODS%%.MSTR_CNCT_BALN_TRNF_PRTP
--WHERE SRCE_SYST_ISAC_CODE = 'E001'
--AND COALESCE(OBJC_BDT_APPT, '') <> '' QUALIFY RANK() OVER (PARTITION BY  INTR_CNCT_NUMB_OF_MAIN_CNCT , ELEM_OF_A_CNCT_HIER_GRUP , OBJC_BDT_APPT ORDER BY LOAD_S DESC) = 1
--) D ON D.INTR_CNCT_NUMB_OF_MAIN_CNCT = OPEN_MC.INTR_CNCT_NUMB_OF_MAIN_CNCT


--LEFT OUTER JOIN
--(SEL * FROM   %%VCBODS%%.MSTR_CNCT_PRXY_ACCT
-- WHERE SRCE_SYST_ISAC_CODE = 'E001' AND CNCT_TYPE_KEY IN ('5', '6') QUALIFY RANK() OVER (PARTITION BY ELEM_OF_A_CNCT_HIER_GRUP, CNCT_TYPE_KEY ORDER BY LOAD_S DESC ) = 1
--) E ON E.ELEM_OF_A_CNCT_HIER_GRUP = D.ELEM_OF_A_CNCT_HIER_GRUP

--LEFT OUTER JOIN  %%VCBODS%%.ACCT_MSTR_DATA_CURR F ON F.ACCT = E.EXTL_CNCT_PART_1 AND CNCT_CATG = '0001'

--LEFT JOIN
--(SEL * FROM  %%VCBODS%%.WUL_NON_SAP_ACCT QUALIFY RANK()OVER(PARTITION BY ACCT_I ORDER BY  LOAD_S DESC)=1)  G ON  'HLSHL'||E.NON_SAP_ACCT_NUMB=G.ACCT_I

--INNER JOIN %%VEXTR%%.BD_SALE_PDCT P ON P.SALES_PRODUCT_CODE = PARTICIPATE_ACCOUNT_SP

--WHERE PARTICIPATE_ACCOUNT_SOURCE IS NOT NULL GROUP BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14 , 15 , 16 , 17 , 18 , 19 , 20 )
--WITH DATA PRIMARY INDEX(OFFSET_MC_ID)
--ON COMMIT PRESERVE ROWS
                       ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

CREATE OR REPLACE TEMPORARY TABLE EDO_MC_RECONCILIATION_GDW_1710
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
	SELECT DISTINCT  A.ACCT_I,
		TRIM(A.PDCT_N) AS MC_PDCT_N,
		B.OFFR_I,
		B.ACCT_OFFR_STRT_D,
		B.ACCT_OFFR_END_D,
		OBJC_ACCT_I,
		TRIM(D.PDCT_N) AS PARTICIPANT_PDCT_N
		FROM (
			SELECT
				*
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '86' COLUMN '13' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '86' COLUMN '13'. FAILED TOKEN WAS '%' ON LINE '86' COLUMN '18'. **
--				  FROM %%VTECH%%.ACCT_PDCT
				                           WHERE
				UPPER(RTRIM( PDCT_N)) = UPPER(RTRIM('1603'))
			AND ACCT_I IN (
					SELECT
						ACCT_I
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '87' COLUMN '27' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '87' COLUMN '27'. FAILED TOKEN WAS '%' ON LINE '87' COLUMN '32'. **
--						       FROM %%VTECH%%.ACCT_BASE
						                                WHERE ACCT_I ILIKE 'SAPMC%' AND UPPER(RTRIM(COALESCE(CLSE_D,DATE'9999-12-31'))) = UPPER(RTRIM('9999-12-31')))
			AND CURRENT_DATE() -1 BETWEEN EFFT_D AND EXPY_D) A
		LEFT JOIN
		(
				SELECT
					*
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '90' COLUMN '8' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '90' COLUMN '8'. FAILED TOKEN WAS '%' ON LINE '90' COLUMN '13'. **
--					  FROM %%VTECH%%.ACCT_OFFR
					                           WHERE
					UPPER(RTRIM( ACCT_OFFR_END_D)) = UPPER(RTRIM('9999-12-31')) AND CURRENT_DATE() -1 BETWEEN EFFT_D AND EXPY_D) B ON A.ACCT_I = B.ACCT_I
		JOIN (
				SELECT
					*
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '91' COLUMN '13' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '91' COLUMN '13'. FAILED TOKEN WAS '%' ON LINE '91' COLUMN '18'. **
--					  FROM %%VTECH%%.ACCT_REL
			WHERE Rel_c ILIKE 'MC%' and CURRENT_DATE() -1 BETWEEN EFFT_D AND EXPY_D)C ON A.ACCT_I = C.SUBJ_ACCT_I
		LEFT JOIN (
				SELECT
					*
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '93' COLUMN '18' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '93' COLUMN '18'. FAILED TOKEN WAS '%' ON LINE '93' COLUMN '23'. **
--					  FROM %%VTECH%%.ACCT_PDCT
					                           WHERE
				ACCT_I IN (
						SELECT
							ACCT_I
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '94' COLUMN '23' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '94' COLUMN '23'. FAILED TOKEN WAS '%' ON LINE '94' COLUMN '28'. **
--							       FROM %%VTECH%%.ACCT_BASE
							                                WHERE ACCT_I ILIKE ANY ('HLSHL%','SAPSP%') AND UPPER(RTRIM(COALESCE(CLSE_D,DATE'9999-12-31'))) = UPPER(RTRIM('9999-12-31')))
				AND CURRENT_DATE() -1 BETWEEN EFFT_D AND EXPY_D) D
		ON D.ACCT_I = C.OBJC_ACCT_I GROUP BY 1,2,3,4,5,6,7
)
----** SSC-FDM-0008 - ON COMMIT NOT SUPPORTED **
--ON COMMIT PRESERVE ROWS
                       ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--** SSC-FDM-0007 - MISSING DEPENDENT OBJECT "XUJE_OFFSET_MC_RPT_1710" **
CREATE OR REPLACE TEMPORARY TABLE HLS_DIFF_ODS_GDW_1710
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
	SELECT DISTINCT A.* FROM
	(
		SELECT
				* FROM
				XUJE_OFFSET_MC_RPT_1710
		WHERE
				UPPER(RTRIM( PARTICIPATE_ACCOUNT_SOURCE)) = UPPER(RTRIM('HLS')) AND DATE_OF_LINKAGE <= CURRENT_DATE() -2 AND EXPIRE_OF_LINKAGE >= CURRENT_DATE() -2
			AND UPPER(RTRIM( PACKAGE_STATUS)) <> UPPER(RTRIM('CLOSED'))) A
		LEFT JOIN
		(
				SELECT
					SUBSTR(ACCT_I, 10) AS OFFSET_MC_NUMBER,
					PARTICIPANT_PDCT_N AS PARTICIPATE_ACCOUNT_SP,
					SUBSTR(OBJC_ACCT_I, 6) AS
					PARTICIPATE_ACCOUNT_NUMBER FROM
					EDO_MC_RECONCILIATION_GDW_1710
				WHERE
					UPPER(RTRIM(SUBSTR(OBJC_ACCT_I, 1, 3))) = UPPER(RTRIM('HLS'))
		)B
	ON
	CAST(A.OFFSET_MC_NUMBER AS NUMBER(38, 18)) = CAST(B.OFFSET_MC_NUMBER AS NUMBER(38, 18))
	AND
	CAST(A.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18)) = CAST(B.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18))
	WHERE B.OFFSET_MC_NUMBER IS NULL
)
----** SSC-FDM-0008 - ON COMMIT NOT SUPPORTED **
--ON COMMIT PRESERVE ROWS
                       ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--** SSC-FDM-0007 - MISSING DEPENDENT OBJECT "XUJE_OFFSET_MC_RPT_1710" **
CREATE OR REPLACE TEMPORARY TABLE SAP_DIFF_ODS_GDW_1710
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
	SELECT DISTINCT A.* FROM
	(
		SELECT
				* FROM
				XUJE_OFFSET_MC_RPT_1710
		WHERE
				UPPER(RTRIM( PARTICIPATE_ACCOUNT_SOURCE)) = UPPER(RTRIM('SAP')) AND DATE_OF_LINKAGE <= CURRENT_DATE() -2 AND EXPIRE_OF_LINKAGE >= CURRENT_DATE() -2
			AND UPPER(RTRIM( PACKAGE_STATUS)) <> UPPER(RTRIM('CLOSED'))) A
		LEFT JOIN
		(
				SELECT
					SUBSTR(ACCT_I, 10) AS OFFSET_MC_NUMBER,
					SUBSTR(OBJC_ACCT_I, 8, 6) AS PARTICIPATE_ACCOUNT_BSB,
					SUBSTR(OBJC_ACCT_I, 14) AS
	PARTICIPATE_ACCOUNT_NUMBER FROM
					EDO_MC_RECONCILIATION_GDW_1710
				WHERE
					UPPER(RTRIM(SUBSTR(OBJC_ACCT_I, 1, 3))) = UPPER(RTRIM('SAP'))
		)B
	ON
	CAST(A.OFFSET_MC_NUMBER AS NUMBER(38, 18)) = CAST(B.OFFSET_MC_NUMBER AS NUMBER(38, 18))
	AND
	CAST(A.PARTICIPATE_ACCOUNT_BSB AS NUMBER(38, 18)) = CAST(B.PARTICIPATE_ACCOUNT_BSB AS NUMBER(38, 18))
	AND
	CAST(A.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18)) = CAST(B.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18))
	WHERE B.OFFSET_MC_NUMBER IS NULL
)
----** SSC-FDM-0008 - ON COMMIT NOT SUPPORTED **
--ON COMMIT PRESERVE ROWS
                       ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!


.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--Missing from GDW to Sap:
--** SSC-FDM-0007 - MISSING DEPENDENT OBJECT "XUJE_OFFSET_MC_RPT_1710" **
CREATE OR REPLACE TEMPORARY TABLE HLS_DIFF_GDW_ODS_1710
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
	SELECT DISTINCT A.* FROM
		 (
		SELECT
				SUBSTR(ACCT_I, 10) AS OFFSET_MC_NUMBER,
				PARTICIPANT_PDCT_N AS PARTICIPATE_ACCOUNT_SP,
				SUBSTR(OBJC_ACCT_I, 6) AS
				PARTICIPATE_ACCOUNT_NUMBER FROM
				EDO_MC_RECONCILIATION_GDW_1710
		WHERE
				UPPER(RTRIM(SUBSTR(OBJC_ACCT_I, 1, 3))) = UPPER(RTRIM('HLS'))
		)A
		LEFT JOIN
	(
				SELECT
					* FROM
					XUJE_OFFSET_MC_RPT_1710
				WHERE
					UPPER(RTRIM( PARTICIPATE_ACCOUNT_SOURCE)) = UPPER(RTRIM('HLS')) )B
	ON
	CAST(A.OFFSET_MC_NUMBER AS NUMBER(38, 18)) = CAST(B.OFFSET_MC_NUMBER AS NUMBER(38, 18))
	AND
	CAST(A.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18)) = CAST(B.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18))
	WHERE B.OFFSET_MC_NUMBER IS NULL
)
----** SSC-FDM-0008 - ON COMMIT NOT SUPPORTED **
--ON COMMIT PRESERVE ROWS
                       ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--** SSC-FDM-0007 - MISSING DEPENDENT OBJECT "XUJE_OFFSET_MC_RPT_1710" **
CREATE OR REPLACE TEMPORARY TABLE SAP_DIFF_GDW_ODS_1710
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
	SELECT DISTINCT A.* FROM
		 (
		SELECT
				SUBSTR(ACCT_I, 10) AS OFFSET_MC_NUMBER,
				SUBSTR(OBJC_ACCT_I, 8, 6) AS PARTICIPATE_ACCOUNT_BSB,
				SUBSTR(OBJC_ACCT_I, 14) AS
	PARTICIPATE_ACCOUNT_NUMBER FROM
				EDO_MC_RECONCILIATION_GDW_1710
		WHERE
				UPPER(RTRIM(SUBSTR(OBJC_ACCT_I, 1, 3))) = UPPER(RTRIM('SAP'))
		) A
		LEFT JOIN
	(
				SELECT
					* FROM
					XUJE_OFFSET_MC_RPT_1710
				WHERE
					UPPER(RTRIM( PARTICIPATE_ACCOUNT_SOURCE)) = UPPER(RTRIM('SAP')) ) B
	ON
	CAST(A.OFFSET_MC_NUMBER AS NUMBER(38, 18)) = CAST(B.OFFSET_MC_NUMBER AS NUMBER(38, 18))
	AND
	CAST(A.PARTICIPATE_ACCOUNT_BSB AS NUMBER(38, 18)) = CAST(B.PARTICIPATE_ACCOUNT_BSB AS NUMBER(38, 18))
	AND
	CAST(A.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18)) = CAST(B.PARTICIPATE_ACCOUNT_NUMBER AS NUMBER(38, 18))
	WHERE B.OFFSET_MC_NUMBER IS NULL

)
----** SSC-FDM-0008 - ON COMMIT NOT SUPPORTED **
--ON COMMIT PRESERVE ROWS
                       ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '185' COLUMN '0' OF THE SOURCE CODE STARTING AT 'CREATE'. EXPECTED 'Create table Statement' GRAMMAR. LAST MATCHING TOKEN WAS 'JOIN' ON LINE '223' COLUMN '18'. **
--CREATE MULTISET VOLATILE TABLE MCMDG_CH_L3BR21 AS
--(
--SELECT
--           MCMDG.INTR_CNCT_NUMB_OF_MAIN_CNCT,
--           MCMDG.ACCT_I,
--           MCMDG.SRCE_SYST_ISAC_CODE AS MCMDG_SRCE_SYST_ISAC_CODE,
--           MCMDG.LOAD_S AS MCMDG_LOAD_S,
--           CH.CNCT,
--           CH.SRCE_SYST_ISAC_CODE AS CH_SRCE_SYST_ISAC_CODE,
--           CH.VALD_FROM,
--           CH.LOAD_S AS CH_LOAD_S,
--           CH.CTCT_STUS,
--           UTIL.RUN_STRM_PROS_D ,
--           MCMDG.ACTL_VALD_END ,
--           CH.PDCT
--           ,UTIL.EXT_FROM_S
--           ,UTIL.EXT_TO_S
--           ,UTIL.SRCE_SYST_ISAC
--      FROM
--           (SEL * FROM  %%VCBODS%%.MSTR_CNCT_MSTR_DATA_GENL WHERE
--(INTR_CNCT_NUMB_OF_MAIN_CNCT,SRCE_SYST_ISAC_CODE,LOAD_S ) IN
--(SELECT  INTR_CNCT_NUMB_OF_MAIN_CNCT,SRCE_SYST_ISAC_CODE,
--MAX(LOAD_S) FROM  %%VCBODS%%.MSTR_CNCT_MSTR_DATA_GENL GROUP BY 1,2) and Mstr_Cnct_numb in (
--Sel OFFSET_MC_NUMBER from  HLS_DIFF_ODS_GDW_1710 WHERE ACCT_STATUS='OPEN' AND EXPIRE_OF_LINKAGE='9999-12-31')) AS MCMDG
--            INNER JOIN
--           (
--           SELECT
--           SRCE_SYST_ISAC
--           ,EXT_FROM_S
--           ,EXT_TO_S
--           ,RUN_STRM_PROS_D
--           FROM  %%UTILSTG%%.CBM_UTIL_RUN_STRM_OCCR_CNTL_H
--           WHERE  RUN_STRM_C='SAP00'
--           GROUP BY 1,2,3,4
--           )UTIL
--           ON UTIL.SRCE_SYST_ISAC=MCMDG.SRCE_SYST_ISAC_CODE
--           AND MCMDG.LOAD_S <= UTIL.EXT_TO_S
--           AND MCMDG.VALD_STRT <= UTIL.RUN_STRM_PROS_D
--           INNER JOIN  %%VCBODS%%.CNCT_HEAD CH
--           ON CH.CNCT = MCMDG.INTR_CNCT_NUMB_OF_MAIN_CNCT
--           AND CH.SRCE_SYST_ISAC_CODE = MCMDG.SRCE_SYST_ISAC_CODE
--           AND CH.LOAD_S <= UTIL.EXT_TO_S
--           AND CH.VALD_FROM <= UTIL.RUN_STRM_PROS_D
--           QUALIFY RANK() OVER(PARTITION BY MCMDG.INTR_CNCT_NUMB_OF_MAIN_CNCT,MCMDG.SRCE_SYST_ISAC_CODE
--           ORDER BY MCMDG.LOAD_S DESC,MCMDG.VALD_STRT DESC,MCMDG.CHNG_TIME_STMP DESC,CH.LOAD_S DESC,CH.VALD_FROM DESC) = 1
--		   )
--		   WITH DATA PRIMARY INDEX(INTR_CNCT_NUMB_OF_MAIN_CNCT)
--		   ON COMMIT PRESERVE ROWS
		                          ;

		   !!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

CREATE OR REPLACE TEMPORARY TABLE ACCT_REL_TRNF_PRTP_1
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
	SELECT
		MCL.ACCT_I AS SUBJ_ACCT_I,
		CASE
		WHEN UPPER(RTRIM(MCBTP.CNCT_CATG)) = UPPER(RTRIM('0001'))
		and	MCPA.NON_SAP_ACCT_IDNN  is NULL
				THEN AMD.ACCT_I
		WHEN UPPER(RTRIM(MCBTP.CNCT_CATG)) = UPPER(RTRIM('0001')) and	MCPA.NON_SAP_ACCT_IDNN  is NOT NULL
				THEN WNSA.ACCT_I
		WHEN UPPER(RTRIM(MCBTP.CNCT_CATG)) = UPPER(RTRIM('0003'))
				THEN MCL.ACCT_I ELSE NULL
		END AS OBJC_ACCT_I,
		MCBTP.OBJC_BDT_APPT,
		MCBTP.VALD_FROM,
		MCBTP.ACTL_VALD_END,
		CASE
		WHEN MSAR.REL_C IS NULL
				THEN '9999' ELSE	MSAR.REL_C
		END AS REL_C,
		CASE
		WHEN MSAR.MIRR_REL_C IS NULL
				THEN '9999' ELSE	MSAR.MIRR_REL_C
		END AS MIRR_REL_C,
		MCL.CTCT_STUS,
		MCBTP.INTR_CNCT_NUMB_OF_MAIN_CNCT,
		MCBTP.HIER_ID,
		MCBTP.CNCT_CATG,
		CASE
		WHEN MCBTP.INTR_CNCT_NUMB_OF_MAIN_CNCT = MCBTP.HIER_ID
				THEN 0 Else	1
		END AS LAVEL,
		MCL.RUN_STRM_PROS_D
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '255' COLUMN '21' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '255' COLUMN '21'. FAILED TOKEN WAS '%' ON LINE '257' COLUMN '2'. **
--		                    FROM
----(SEL * FROM  %%VCBODS%%.MSTR_CNCT_BALN_TRNF_PRTP WHERE INTR_CNCT_NUMB_OF_MAIN_CNCT='EAE1C3831B5B23C0E10080000A1F20D4' ) AS MCBTP
-- %%VCBODS%%.MSTR_CNCT_BALN_TRNF_PRTP   as MCBTP
--INNER JOIN        /*CONTROL TABLE ENTRY HAS BEEN INCLUDED  FOR THE PURPOSE OF PROPBLEM TICKET#PM0024182*/
--(--SELECT MAX(EXT_FROM_S) AS EXT_FROM_S,MAX(EXT_TO_S) AS EXT_TO_S
--SELECT EXT_FROM_S,EXT_TO_S
WHERE
		UPPER(RTRIM(
		RUN_STRM_C)) = UPPER(RTRIM('SAP00' --AND RUN_STRM_PROS_D='2018-08-24'
		))
);
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '262' COLUMN '3' OF THE SOURCE CODE STARTING AT 'AS'. EXPECTED 'STATEMENT' GRAMMAR. LAST MATCHING TOKEN WAS 'CREATE' ON LINE '237' COLUMN '3'. FAILED TOKEN WAS 'AS' ON LINE '262' COLUMN '3'. **
--   AS CCEDW
--ON MCBTP.LOAD_S<=CCEDW.EXT_TO_S
--INNER JOIN  MCMDG_CH_L3BR21 MCL
--ON MCBTP.INTR_CNCT_NUMB_OF_MAIN_CNCT=MCL.INTR_CNCT_NUMB_OF_MAIN_CNCT
--AND MCBTP.SRCE_SYST_ISAC_CODE=MCL.MCMDG_SRCE_SYST_ISAC_CODE
--AND (MCBTP.CNCT_CATG = '0001' OR MCBTP.CNCT_CATG = '0003')
--AND (MCBTP.LOAD_S <=MCL.EXT_TO_S AND COALESCE(MCBTP.UPD_LOAD_S,TIMESTAMP '9999-12-31 00:00:00.000000')>MCL.EXT_TO_S)
--AND MCBTP.VALD_FROM<=MCL.RUN_STRM_PROS_D
--LEFT JOIN  %%VCBODS%%.MSTR_CNCT_PRXY_ACCT MCPA
--ON MCPA.ELEM_OF_A_CNCT_HIER_GRUP=MCBTP.ELEM_OF_A_CNCT_HIER_GRUP
--AND MCPA.SRCE_SYST_ISAC_CODE=MCBTP.SRCE_SYST_ISAC_CODE
--AND ( MCPA.CNCT_TYPE_KEY=5 OR MCPA.CNCT_TYPE_KEY=6)
--AND MCPA.LOAD_S<=MCL.EXT_TO_S
--LEFT JOIN  %%VCBODS%%.ACCT_MSTR_DATA AMD
--ON AMD.ACCT = MCPA.EXTL_CNCT_PART_1
--AND AMD.SRCE_SYST_ISAC_CODE = MCPA.SRCE_SYST_ISAC_CODE
--AND (AMD.LOAD_S <=MCL.EXT_TO_S AND COALESCE(AMD.UPD_LOAD_S,TIMESTAMP '9999-12-31 00:00:00.000000')> MCL.EXT_TO_S)
--LEFT JOIN
-- %%VCBODS%%.WUL_NON_SAP_ACCT WNSA
--ON MCPA.NON_SAP_ACCT_NUMB = WNSA.SRCE_SYST_ACCT_NUMB
----AND CAST(MCPA.CIF_PDCT_IDNN AS DECIMAL(4,0)) = WNSA.PDCT_IDNN 
--AND MCPA.APPT_CODE =WNSA.NON_SAP_CNCT_APPT_CODE
----AND WNSA.LOAD_S<=MCL.EXT_TO_S
--LEFT JOIN %%VTECH%%.MAP_SAP_INVL_PDCT MSIP
--ON AMD.PDCT =MSIP.PDCT
--AND CAST( MCL.RUN_STRM_PROS_D  AS DATE FORMAT 'YYYYMMDD') BETWEEN MSIP.EFFT_D AND MSIP.EXPY_D
--LEFT OUTER JOIN %%VTECH%%.MAP_SAP_ACCT_REL MSAR
--ON MSAR.SRCE_TABL_M='MSTR_CNCT_BALN_TRNF_PRTP'
--AND MSAR.SRCE_COLM_M='OBJC_BDT_APPT'
--AND MSAR.SRCE_VALU_C=MCBTP.OBJC_BDT_APPT
--AND CAST( MCL.RUN_STRM_PROS_D  AS DATE FORMAT 'YYYYMMDD') BETWEEN MSAR.EFFT_D AND MSAR.EXPY_D
--WHERE
--(
----MCBTP.LOAD_S >=MCL.EXT_FROM_S  
--MCBTP.LOAD_S >CCEDW.EXT_FROM_S
--OR
--MCL.CH_LOAD_S>=MCL.EXT_FROM_S
--OR
--MCL.MCMDG_LOAD_S>=MCL.EXT_FROM_S
--OR
--MCPA.LOAD_S >=MCL.EXT_FROM_S
--)
--AND
--OBJC_ACCT_I IS NOT NULL
--AND SUBJ_ACCT_I<>OBJC_ACCT_I
--AND COALESCE (MSIP.PDCT_C,'') <> 'INVL'
--QUALIFY
--RANK()OVER(PARTITION BY MCBTP.HIER_ID, MCBTP.SRCE_SYST_ISAC_CODE ORDER BY MCBTP.LOAD_S DESC)=1
--AND RANK()OVER(PARTITION BY MCPA.ELEM_OF_A_CNCT_HIER_GRUP, MCPA.SRCE_SYST_ISAC_CODE ORDER BY MCPA.LOAD_S DESC)=1
--AND RANK()OVER(PARTITION BY WNSA.SRCE_SYST_ACCT_NUMB, WNSA.PDCT_IDNN, WNSA.NON_SAP_CNCT_APPT_CODE ORDER BY WNSA.LOAD_S DESC)=1
--		   )
--		   WITH DATA PRIMARY INDEX(SUBJ_ACCT_I)
--		   ON COMMIT PRESERVE ROWS
		                          ;

		   !!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

CREATE OR REPLACE TEMPORARY TABLE ACCT_REL_TRNF_PRTP_2
COMMENT = '{ "origin": "sf_sc", "name": "snowconvert", "version": {  "major": 1,  "minor": 16,  "patch": "1.0" }, "attributes": {  "component": "teradata",  "convertedOn": "08/19/2025",  "domain": "snowflake" }}'
AS
(
SELECT
		* FROM
		ACCT_REL_TRNF_PRTP_1
WHERE OBJC_ACCT_I NOT IN (
		SELECT
				OBJC_ACCT_I
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '321' COLUMN '75' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '321' COLUMN '75'. FAILED TOKEN WAS '%' ON LINE '321' COLUMN '80'. **
--				            FROM %%VTECH%%.ACCT_REL
				                                    WHERE REL_C NOT ILIKE '%MC%' AND
			SUBJ_ACCT_I ILIKE 'SAPMC%' AND OBJC_ACCT_I ILIKE 'HLS%')
	AND OBJC_ACCT_I ILIKE 'HLS%'
QUALIFY
		ROW_NUMBER() OVER (PARTITION BY SUBJ_ACCT_I,OBJC_ACCT_I,OBJC_BDT_APPT,VALD_FROM,REL_C
	,MIRR_REL_C,CTCT_STUS,INTR_CNCT_NUMB_OF_MAIN_CNCT,HIER_ID,CNCT_CATG,LAVEL
	ORDER BY RUN_STRM_PROS_D) = 1
		   )
----** SSC-FDM-0008 - ON COMMIT NOT SUPPORTED **
--		   ON COMMIT PRESERVE ROWS
		                          ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--!!!RESOLVE EWI!!! /*** SSC-EWI-0013 - EXCEPTION THROWN WHILE CONVERTING ITEM: Mobilize.T12Data.Sql.Ast.TdDelete. LINE: 333 OF FILE: /Users/psundaram/Documents/prjs/cba/agentic/bteq/BTEQ_SAP_EDO_WKLY_LOAD.sql ***/!!!

--DELETE
-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '333' COLUMN '7' OF THE SOURCE CODE STARTING AT 'FROM'. EXPECTED 'FROM' GRAMMAR. LAST MATCHING TOKEN WAS 'FROM' ON LINE '333' COLUMN '7'. FAILED TOKEN WAS '%' ON LINE '333' COLUMN '13'. **
--       FROM  %%DDSTG%%.ACCT_REL_HLS_REME
                                        ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '337' COLUMN '1' OF THE SOURCE CODE STARTING AT 'INSERT'. EXPECTED 'Insert' GRAMMAR. LAST MATCHING TOKEN WAS 'INTO' ON LINE '337' COLUMN '8'. **
-- INSERT INTO  %%DDSTG%%.ACCT_REL_HLS_REME
-- SELECT
--	  SRC.SUBJ_ACCT_I
--	  ,SRC.OBJC_ACCT_I
--	  ,SRC.OBJC_BDT_APPT
--	  ,SRC.VALD_FROM
--	  ,SRC.ACTL_VALD_END
--	  ,SRC.REL_C
--	  ,SRC.MIRR_REL_C
--	  ,SRC.CTCT_STUS
--	  ,SRC.INTR_CNCT_NUMB_OF_MAIN_CNCT
--	  ,SRC.HIER_ID
--	  ,SRC.CNCT_CATG
--	  ,SRC.RUN_STRM_PROS_D
--	  ,SRC.OBJC_ACCT_LEVL_N
--	  ,SRC.SUBJ_ACCT_LEVL_N
--	  ,AR.EFFT_D AS TGT_EFFT_D
--	  ,CASE WHEN  AR.SUBJ_ACCT_I IS NULL AND SRC.ACTL_VALD_END > SRC.RUN_STRM_PROS_D THEN 'I'
--	       WHEN  AR.SUBJ_ACCT_I=SRC.SUBJ_ACCT_I  AND ( SRC.SUBJ_ACCT_LEVL_N <> AR.SUBJ_ACCT_LEVL_N OR SRC.OBJC_ACCT_LEVL_N <> AR.OBJC_ACCT_LEVL_N) AND SRC.ACTL_VALD_END > SRC.RUN_STRM_PROS_D THEN 'U'
--	       WHEN  AR.SUBJ_ACCT_I=SRC.SUBJ_ACCT_I  AND ( SRC.CTCT_STUS='50' OR SRC.ACTL_VALD_END <= SRC.RUN_STRM_PROS_D) THEN 'D'
--	       ELSE 'C'
--	  END AS FLG
--	  FROM
--	  (
--	  SELECT
--	  ARTP.SUBJ_ACCT_I
--	     ,ARTP.OBJC_ACCT_I
--	     ,ARTP.OBJC_BDT_APPT
--	     ,ARTP.VALD_FROM
--	     ,ARTP.ACTL_VALD_END
--	     ,ARTP.REL_C
--	     ,ARTP.MIRR_REL_C
--	     ,ARTP.CTCT_STUS
--	     ,ARTP.INTR_CNCT_NUMB_OF_MAIN_CNCT
--	     ,ARTP.HIER_ID
--	     ,ARTP.CNCT_CATG
--	     ,ARTP.LAVEL
--	     ,ARTP.RUN_STRM_PROS_D
--	     ,ARTP1.OBJC_ACCT_LEVL_N
--	     ,CASE WHEN ARTP2.SUBJ_ACCT_LEVL_N IS NULL THEN 1 ELSE ARTP2.SUBJ_ACCT_LEVL_N END AS SUBJ_ACCT_LEVL_N
--	     FROM
--	      ACCT_REL_TRNF_PRTP_2 ARTP
--	     LEFT OUTER JOIN
--	     (SELECT COUNT(*)+1 AS OBJC_ACCT_LEVL_N,OBJC_ACCT_I,HIER_ID
--	      FROM  ACCT_REL_TRNF_PRTP_2
--	      GROUP BY OBJC_ACCT_I,HIER_ID
--	     )ARTP1
--	     ON ARTP.OBJC_ACCT_I=ARTP1.OBJC_ACCT_I
--	     AND ARTP.HIER_ID=ARTP1.HIER_ID
--	     LEFT OUTER JOIN
--	     (
--	      SELECT COUNT(*)+1 AS SUBJ_ACCT_LEVL_N,OBJC_ACCT_I,HIER_ID
--	      FROM  ACCT_REL_TRNF_PRTP_2
--	      GROUP BY OBJC_ACCT_I,HIER_ID
--	     )ARTP2
--	     ON ARTP.SUBJ_ACCT_I=ARTP2.OBJC_ACCT_I
--	     AND ARTP.HIER_ID=ARTP2.HIER_ID
--	  ) SRC
--	  LEFT JOIN

--	   %%VTECH%%.ACCT_REL AR
--	  ON AR.SUBJ_ACCT_I=SRC.SUBJ_ACCT_I
--	  AND AR.OBJC_ACCT_I=SRC.OBJC_ACCT_I
--	  AND AR.REL_C=SRC.REL_C
--	  AND EXPY_D='9999-12-31'
--	  WHERE
--	  FLG <>'C'
	            ;

	  !!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

	.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '407' COLUMN '0' OF THE SOURCE CODE STARTING AT 'INSERT'. EXPECTED 'Insert' GRAMMAR. LAST MATCHING TOKEN WAS 'INTO' ON LINE '407' COLUMN '7'. **
--INSERT INTO  %%DDSTG%%.ACCT_REL_HLS_REME_HIST
--SEL
-- SUBJ_ACCT_I
--,OBJC_ACCT_I
--,OBJC_BDT_APPT
--,VALD_FROM
--,ACTL_VALD_END
--,REL_C
--,MIRR_REL_C
--,CTCT_STUS
--,INTR_CNCT_NUMB_OF_MAIN_CNCT
--,HIER_ID
--,CNCT_CATG
--,RUN_STRM_PROS_D
--,OBJC_ACCT_LEVL_N
--,SUBJ_ACCT_LEVL_N
--,TGT_EFFT_D
--,FLG
--,CURRENT_DATE AS LOAD_DATE
--FROM
-- %%DDSTG%%.ACCT_REL_HLS_REME
                            ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '431' COLUMN '1' OF THE SOURCE CODE STARTING AT 'INSERT'. EXPECTED 'Insert' GRAMMAR. LAST MATCHING TOKEN WAS 'INTO' ON LINE '431' COLUMN '8'. **
-- INSERT INTO  %%DDSTG%%.UTIL_PROS_SAP_RUN
-- VALUES
-- (CURRENT_DATE,1,(SEL COALESCE(COUNT(*),0) FROM  %%DDSTG%%.ACCT_REL_HLS_REME))
                                                                              ;

 !!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '437' COLUMN '0' OF THE SOURCE CODE STARTING AT 'INSERT'. EXPECTED 'Insert' GRAMMAR. LAST MATCHING TOKEN WAS 'INTO' ON LINE '437' COLUMN '7'. **
--INSERT INTO  %%STARDATADB%%.ACCT_REL
--(
--SUBJ_ACCT_I,
--OBJC_ACCT_I,
--REL_C,
--EFFT_D,
--EXPY_D,
--STRT_D,
--REL_EXPY_D,
--PROS_KEY_EFFT_I,
--PROS_KEY_EXPY_I,
--EROR_SEQN_I,
--ROW_SECU_ACCS_C,
--REL_STUS_C,
--SRCE_SYST_C,
--SUBJ_ACCT_LEVL_N,
--OBJC_ACCT_LEVL_N,
--CRIN_SHRE_P,
--DR_INT_SHRE_P,
--RECORD_DELETED_FLAG,
--CTL_ID,
--PROCESS_NAME,
--PROCESS_ID,
--UPDATE_PROCESS_NAME,
--UPDATE_PROCESS_ID
--)
--SEL
--SUBJ_ACCT_I,
--OBJC_ACCT_I,
--REL_C,
--RUN_STRM_PROS_D AS EFFT_D,
--'9999-12-31' AS EXPY_D,
--RUN_STRM_PROS_D AS STRT_D,
--NULL AS REL_EXPY_D,
--(SEL MAX(PROS_KEY_EFFT_I) FROM  %%DDSTG%%.UTIL_PROS_SAP_RUN) AS PROS_KEY_EFFT_I,
--NULL AS PROS_KEY_EXPY_I,
--NULL AS EROR_SEQN_I,
--0 AS ROW_SECU_ACCS_C,
--'N' AS REL_STUS_C,
--'SAP' AS SRCE_SYST_C,
--SUBJ_ACCT_LEVL_N,
--OBJC_ACCT_LEVL_N,
--NULL AS CRIN_SHRE_P,
--NULL AS DR_INT_SHRE_P,
--0 AS RECORD_DELETED_FLAG,
--0 AS CTL_ID,
--'NON_CTLFW' AS PROCESS_NAME,
--0 AS PROCESS_ID,
--NULL AS UPDATE_PROCESS_NAME,
--NULL AS UPDATE_PROCESS_ID
--FROM  %%DDSTG%%.ACCT_REL_HLS_REME WHERE OBJC_ACCT_I LIKE 'HLS%'
                                                               ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '491' COLUMN '0' OF THE SOURCE CODE STARTING AT 'INSERT'. EXPECTED 'Insert' GRAMMAR. LAST MATCHING TOKEN WAS 'INTO' ON LINE '491' COLUMN '7'. **
--INSERT INTO  %%STARDATADB%%.ACCT_REL
--(
--SUBJ_ACCT_I,
--OBJC_ACCT_I,
--REL_C,
--EFFT_D,
--EXPY_D,
--STRT_D,
--REL_EXPY_D,
--PROS_KEY_EFFT_I,
--PROS_KEY_EXPY_I,
--EROR_SEQN_I,
--ROW_SECU_ACCS_C,
--REL_STUS_C,
--SRCE_SYST_C,
--SUBJ_ACCT_LEVL_N,
--OBJC_ACCT_LEVL_N,
--CRIN_SHRE_P,
--DR_INT_SHRE_P,
--RECORD_DELETED_FLAG,
--CTL_ID,
--PROCESS_NAME,
--PROCESS_ID,
--UPDATE_PROCESS_NAME,
--UPDATE_PROCESS_ID
--)
--SEL
--OBJC_ACCT_I AS SUBJ_ACCT_I,
--SUBJ_ACCT_I AS OBJC_ACCT_I,
--MIRR_REL_C AS REL_C,
--RUN_STRM_PROS_D AS EFFT_D,
--'9999-12-31' AS EXPY_D,
--RUN_STRM_PROS_D AS STRT_D,
--NULL AS REL_EXPY_D,
--(SEL MAX(PROS_KEY_EFFT_I) FROM %%DDSTG%%.UTIL_PROS_SAP_RUN) AS PROS_KEY_EFFT_I,
--NULL AS PROS_KEY_EXPY_I,
--NULL AS EROR_SEQN_I,
--0 AS ROW_SECU_ACCS_C,
--'N' AS REL_STUS_C,
--'SAP' AS SRCE_SYST_C,
--OBJC_ACCT_LEVL_N AS SUBJ_ACCT_LEVL_N,
--SUBJ_ACCT_LEVL_N AS OBJC_ACCT_LEVL_N,
--NULL AS CRIN_SHRE_P,
--NULL AS DR_INT_SHRE_P,
--0 AS RECORD_DELETED_FLAG,
--0 AS CTL_ID,
--'NON_CTLFW' AS PROCESS_NAME,
--0 AS PROCESS_ID,
--NULL AS UPDATE_PROCESS_NAME,
--NULL AS UPDATE_PROCESS_ID
--FROM  %%DDSTG%%.ACCT_REL_HLS_REME WHERE OBJC_ACCT_I LIKE 'HLS%'
                                                               ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '545' COLUMN '1' OF THE SOURCE CODE STARTING AT 'COLLECT'. EXPECTED 'STATEMENT' GRAMMAR. LAST MATCHING TOKEN WAS 'COLLECT' ON LINE '545' COLUMN '1'. **
--COLLECT STATS ON  %%STARDATADB%%.ACCT_REL
                                         ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '549' COLUMN '0' OF THE SOURCE CODE STARTING AT 'INSERT'. EXPECTED 'Insert' GRAMMAR. LAST MATCHING TOKEN WAS 'INTO' ON LINE '549' COLUMN '7'. **
--INSERT INTO %%STARDATADB%%.UTIL_PROS_ISAC
--SEL
--PROS_KEY_EFFT_I AS PROS_KEY_I
--,'C4182118' AS CONV_M
--,'MNL' AS CONV_TYPE_M
--,CURRENT_TIMESTAMP(0) AS PROS_RQST_S
--,NULL AS PROS_LAST_RQST_S
--,NULL AS PROS_RQST_Q
--,NULL AS BTCH_RUN_D
--,NULL AS BTCH_KEY_I
--,NULL AS SRCE_SYST_M
--,NULL AS SRCE_M
--,'ACCT_REL' AS TRGT_M
--,NULL AS SUCC_F
--,NULL AS COMT_F
--,NULL AS COMT_S
--,NULL AS MLTI_LOAD_EFFT_D
--,NULL AS SYST_S
--,NULL AS MLTI_LOAD_COMT_S
--,NULL AS SYST_ET_Q
--,NULL AS SYST_UV_Q
--,RECD_CNT * 2 AS SYST_INS_Q
--,NULL AS SYST_UPD_Q
--,NULL AS SYST_DEL_Q
--,NULL AS SYST_ET_TABL_M
--,NULL AS SYST_UV_TABL_M
--,NULL AS SYST_HEAD_ET_TABL_M
--,NULL AS SYST_HEAD_UV_TABL_M
--,NULL AS SYST_TRLR_ET_TABL_M
--,NULL AS SYST_TRLR_UV_TABL_M
--,NULL AS PREV_PROS_KEY_I
--,NULL AS HEAD_RECD_TYPE_C
--,NULL AS HEAD_FILE_M
--,NULL AS HEAD_BTCH_RUN_D
--,NULL AS HEAD_FILE_CRAT_S
--,NULL AS HEAD_GENR_PRGM_M
--,NULL AS HEAD_BTCH_KEY_I
--,NULL AS HEAD_PROS_KEY_I
--,NULL AS HEAD_PROS_PREV_KEY_I
--,NULL AS TRLR_RECD_TYPE_C
--,NULL AS TRLR_RECD_Q
--,NULL AS TRLR_HASH_TOTL_A
--,NULL AS TRLR_COLM_HASH_TOTL_M
--,NULL AS TRLR_EROR_RECD_Q
--,NULL AS TRLR_FILE_COMT_S
--,NULL AS TRLR_RECD_ISRT_Q
--,NULL AS TRLR_RECD_UPDT_Q
--,NULL AS TRLR_RECD_DELT_Q
--FROM
-- %%DDSTG%%.UTIL_PROS_SAP_RUN
--WHERE RUN_DATE=CURRENT_DATE AND
--PROS_KEY_EFFT_I = (SEL MAX(PROS_KEY_EFFT_I) FROM %%DDSTG%%.UTIL_PROS_SAP_RUN WHERE RUN_DATE=CURRENT_DATE)
                                                                                                         ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.IF ERRORCODE <> 0 THEN .GOTO EXITERR

-- ** SSC-EWI-0001 - UNRECOGNIZED TOKEN ON LINE '604' COLUMN '1' OF THE SOURCE CODE STARTING AT 'COLLECT'. EXPECTED 'STATEMENT' GRAMMAR. LAST MATCHING TOKEN WAS 'COLLECT' ON LINE '604' COLUMN '1'. **
--COLLECT STATS ON %%STARDATADB%%.UTIL_PROS_ISAC
                                              ;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--** SSC-FDM-0007 - MISSING DEPENDENT OBJECT "XUJE_OFFSET_MC_RPT_1710" **

DROP TABLE XUJE_OFFSET_MC_RPT_1710;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE EDO_MC_RECONCILIATION_GDW_1710;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE HLS_DIFF_ODS_GDW_1710;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE SAP_DIFF_ODS_GDW_1710;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE HLS_DIFF_GDW_ODS_1710;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE SAP_DIFF_GDW_ODS_1710;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

--** SSC-FDM-0007 - MISSING DEPENDENT OBJECT "MCMDG_CH_L3BR21" **

DROP TABLE MCMDG_CH_L3BR21;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE ACCT_REL_TRNF_PRTP_1;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

DROP TABLE ACCT_REL_TRNF_PRTP_2;

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.IF ERRORCODE <> 0 THEN .GOTO EXITERR

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!


.QUIT 0

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!

.LABEL EXITERR

!!!RESOLVE EWI!!! /*** SSC-EWI-0040 - THE STATEMENT IS NOT SUPPORTED IN SNOWFLAKE ***/!!!
.QUIT 4