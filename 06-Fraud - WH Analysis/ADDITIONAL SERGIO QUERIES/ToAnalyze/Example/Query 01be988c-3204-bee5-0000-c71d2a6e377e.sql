SELECT 
    "DSPT_TRAN_PROS_C", 
    "COUNT", 
    concat( CAST (round(("PERCENT" * 100), 2) AS STRING), '%') AS "PERCENT"
 FROM (
 SELECT 
    "DSPT_TRAN_PROS_C", 
    "COUNT", 
    ("COUNT" / sum("COUNT") OVER (  ORDER BY 
    1 :: INT ASC NULLS FIRST  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING )) AS "PERCENT"
 FROM (
 SELECT 
    "DSPT_TRAN_PROS_C", 
    count(1) AS "COUNT"
 FROM (
 SELECT 
     * 
 FROM (
 SELECT 
    "DSPT_CASE_I", 
    "DSPT_CASE_CRAT_I", 
    "DSPT_CASE_CRAT_S", 
    "DSPT_CASE_CLSE_S", 
    "DSPT_CHNL_M", 
    "DSPT_TYPE_X", 
    "DSPT_CASE_USER_STUS_X", 
    "DSPT_CASE_STUS_X", 
    "DSPT_SRCE_SYST_M", 
    "DSPT_TRAN_I", 
    "DSPT_TRAN_REFN_I", 
    "DSPT_TRAN_SYST_TRAC_AUDT_NUMB_I", 
    "DSPT_TRAN_RTRV_RQST_NUMB_C", 
    "DSPT_ACCT_N", 
    "DSPT_CPNN_ACCT_N", 
    "DSPT_DPAN_I", 
    "DSPT_DDA_N", 
    "DSPT_TRAN_TOKN_TYPE_X", 
    "DSPT_TRAN_D", 
    "DSPT_TRAN_S", 
    "DSPT_TRAN_POST_S", 
    "DSPT_TRAN_HOST_SWIT_S", 
    "DSPT_TRAN_ORIG_A", 
    "DSPT_TRAN_ORIG_CNCY_C", 
    "DSPT_TRAN_DEST_A", 
    "DSPT_TRAN_DEST_CNCY_C", 
    "DSPT_TRAN_ACTL_A", 
    "DSPT_TRAN_MERC_DETL_X", 
    "DSPT_TRAN_MERC_CATG_C", 
    "DSPT_TRAN_C", 
    "DSPT_VISA_MAIL_TELE_ORDR_C", 
    "DSPT_MCRD_INPT_MODE_C", 
    "DSPT_TRAN_POS_MODE_C", 
    "DSPT_TRAN_AUTT_NUMB_X", 
    "DSPT_TRAN_DCDE_X", 
    "DSPT_MCRD_AUTN_C", 
    "DSPT_MCRD_SECU_LEVL_INDA_C", 
    "DSPT_MCRD_SECU_LEVL_INDA_X", 
    "DSPT_MCRD_UVRS_CAHD_AUTT_FIED_C", 
    "DSPT_TRAN_CAHD_ACTV_TRML_C", 
    "DSPT_TRAN_CAHD_ACPT_IDNN_I", 
    "DSPT_TRAN_FALL_BACK_C", 
    "DSPT_TRAN_PROS_C", 
    "DSPT_TRAN_CRAT_S", 
    "DSPT_LOAD_TS", 
    "TRAN_I", 
    "CUST_I", 
    "CARD_I", 
    "DPAN_I", 
    "TRAN_MDIA_C", 
    "TRAN_S", 
    "TRAN_D", 
    "TRAN_A", 
    "MERC_M", 
    "TRAN_MERC_CATG_C", 
    "MERC_I", 
    "MERC_TRML_I", 
    "TRAN_ACQR_I", 
    "TRAN_CNTY_C", 
    "TRAN_POS_MODE_C", 
    "TRAN_AUTT_NUMB_X", 
    "TRAN_UPST_DCDE_C", 
    "TRAN_UPST_REAS_C", 
    "TRAN_FINL_DCDE_C", 
    "TRAN_ACCT_AUTT_V", 
    "TRAN_SECU_LEVL_INDA_C", 
    "TRAN_PIN_VERF_F", 
    "TRAN_REVS_F", 
    "TRAN_PAIN_CUST_MERC_F", 
    "TRAN_RCRR_F", 
    "TRAN_MCRD_SCOR_N", 
    "FDP_CARD_PRFL_X", 
    "FDP_RULE_TRIG_X", 
    "FDP_RULE_PUSH_TYPE_F", 
    "FDP_PUSH_EXIT_C", 
    "POST_AUTN_MTCH_SCOR", 
    "SRCE_SYST_C", 
    "LOAD_TS", 
    "ROW_SECU_ACCS_C", 
    "ETL_TS", 
    "ETL_ID", 
    "SNAP_D", 
    "TRAN_ID", 
    "TRAN_DATE", 
    to_char("TRAN_DATE", 'YYYYMMDD') AS "TTS_TRAN_DATE_ALT", 
    'DAISY' AS "DETECT_METHOD"
 FROM (
 SELECT 
    "DSPT_CASE_I", 
    "DSPT_CASE_CRAT_I", 
    "DSPT_CASE_CRAT_S", 
    "DSPT_CASE_CLSE_S", 
    "DSPT_CHNL_M", 
    "DSPT_TYPE_X", 
    "DSPT_CASE_USER_STUS_X", 
    "DSPT_CASE_STUS_X", 
    "DSPT_SRCE_SYST_M", 
    "DSPT_TRAN_I", 
    "DSPT_TRAN_REFN_I", 
    "DSPT_TRAN_SYST_TRAC_AUDT_NUMB_I", 
    "DSPT_TRAN_RTRV_RQST_NUMB_C", 
    "DSPT_ACCT_N", 
    "DSPT_CPNN_ACCT_N", 
    "DSPT_DPAN_I", 
    "DSPT_DDA_N", 
    "DSPT_TRAN_TOKN_TYPE_X", 
    "DSPT_TRAN_D", 
    "DSPT_TRAN_S", 
    "DSPT_TRAN_POST_S", 
    "DSPT_TRAN_HOST_SWIT_S", 
    "DSPT_TRAN_ORIG_A", 
    "DSPT_TRAN_ORIG_CNCY_C", 
    "DSPT_TRAN_DEST_A", 
    "DSPT_TRAN_DEST_CNCY_C", 
    "DSPT_TRAN_ACTL_A", 
    "DSPT_TRAN_MERC_DETL_X", 
    "DSPT_TRAN_MERC_CATG_C", 
    "DSPT_TRAN_C", 
    "DSPT_VISA_MAIL_TELE_ORDR_C", 
    "DSPT_MCRD_INPT_MODE_C", 
    "DSPT_TRAN_POS_MODE_C", 
    "DSPT_TRAN_AUTT_NUMB_X", 
    "DSPT_TRAN_DCDE_X", 
    "DSPT_MCRD_AUTN_C", 
    "DSPT_MCRD_SECU_LEVL_INDA_C", 
    "DSPT_MCRD_SECU_LEVL_INDA_X", 
    "DSPT_MCRD_UVRS_CAHD_AUTT_FIED_C", 
    "DSPT_TRAN_CAHD_ACTV_TRML_C", 
    "DSPT_TRAN_CAHD_ACPT_IDNN_I", 
    "DSPT_TRAN_FALL_BACK_C", 
    "DSPT_TRAN_PROS_C", 
    "DSPT_TRAN_CRAT_S", 
    "DSPT_LOAD_TS", 
    "TRAN_I", 
    "CUST_I", 
    "CARD_I", 
    "DPAN_I", 
    "TRAN_MDIA_C", 
    "TRAN_S", 
    "TRAN_D", 
    "TRAN_A", 
    "MERC_M", 
    "TRAN_MERC_CATG_C", 
    "MERC_I", 
    "MERC_TRML_I", 
    "TRAN_ACQR_I", 
    "TRAN_CNTY_C", 
    "TRAN_POS_MODE_C", 
    "TRAN_AUTT_NUMB_X", 
    "TRAN_UPST_DCDE_C", 
    "TRAN_UPST_REAS_C", 
    "TRAN_FINL_DCDE_C", 
    "TRAN_ACCT_AUTT_V", 
    "TRAN_SECU_LEVL_INDA_C", 
    "TRAN_PIN_VERF_F", 
    "TRAN_REVS_F", 
    "TRAN_PAIN_CUST_MERC_F", 
    "TRAN_RCRR_F", 
    "TRAN_MCRD_SCOR_N", 
    "FDP_CARD_PRFL_X", 
    "FDP_RULE_TRIG_X", 
    "FDP_RULE_PUSH_TYPE_F", 
    "FDP_PUSH_EXIT_C", 
    "POST_AUTN_MTCH_SCOR", 
    "SRCE_SYST_C", 
    "LOAD_TS", 
    "ROW_SECU_ACCS_C", 
    "ETL_TS", 
    "ETL_ID", 
    "SNAP_D", 
    "TRAN_I" AS "TRAN_ID", 
    to_date("TRAN_S") AS "TRAN_DATE"
 FROM LABMLFRD.CARD_TRAN_DAIS_DSPT
 WHERE 
    ("DSPT_TRAN_DCDE_X" IN ('Chargeback', 'Fraud Referral', 'Chargeoff', 'Paypass Transaction Detail', 'Customer Liable') AND ("TRAN_I" != '...'))
)
)
 WHERE 
    (("TTS_TRAN_DATE_ALT" >= '20250615') AND ("TTS_TRAN_DATE_ALT" <= '20250710'))
)
 GROUP BY 
    "DSPT_TRAN_PROS_C"
)
)
 ORDER BY 
    "COUNT" DESC NULLS LAST