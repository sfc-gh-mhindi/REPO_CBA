{
  "success": false,
  "quality_score": 1.0,
  "model_sql": "{%- set process_name = 'ACCT_BALN_BKDT_ISRT' -%}\n{%- set stream_name = 'ACCT_BALN_BKDT' -%}\n\n{{\n  config(\n    materialized='table',\n    database=var('cad_prod_data_db'),\n    schema='acct_baln',\n    tags=['account', 'balance', 'backdate', 'insert'],\n    pre_hook=[\n        \"{{ log_dcf_exec_msg('ACCT_BALN_BKDT_ISRT Process started') }}\"\n    ],\n    post_hook=[\n        \"{{ log_dcf_exec_msg('ACCT_BALN_BKDT_ISRT Process ended') }}\"\n    ]\n  )\n}}\n\n/*\n    Model: ACCT_BALN_BKDT_ISRT\n    Purpose: Populate ACCT's into ACCT BALN with the modified adjustments\n    Business Logic: Insert data from ACCT_BALN_BKDT_STG2 staging table into ACCT_BALN_BKDT\n    Dependencies: ACCT_BALN_BKDT_STG2 staging table\n    \n    Original BTEQ Logic:\n    - Simple INSERT INTO ... SELECT FROM staging table\n    - Preserves all columns and data types from source\n*/\n\nWITH source_data AS (\n    SELECT \n        ACCT_I,                        \n        BALN_TYPE_C,                   \n        CALC_FUNC_C,                   \n        TIME_PERD_C,                   \n        BALN_A,                        \n        CALC_F,                        \n        SRCE_SYST_C,                   \n        ORIG_SRCE_SYST_C,              \n        LOAD_D,                        \n        BKDT_EFFT_D,                   \n        BKDT_EXPY_D,                  \n        PROS_KEY_EFFT_I,               \n        PROS_KEY_EXPY_I,               \n        BKDT_PROS_KEY_I\n    FROM {{ source('ddstg', 'ACCT_BALN_BKDT_STG2') }}\n),\n\nfinal AS (\n    SELECT \n        ACCT_I,                        \n        BALN_TYPE_C,                   \n        CALC_FUNC_C,                   \n        TIME_PERD_C,                   \n        BALN_A,                        \n        CALC_F,                        \n        SRCE_SYST_C,                   \n        ORIG_SRCE_SYST_C,              \n        LOAD_D,                        \n        BKDT_EFFT_D,                   \n        BKDT_EXPY_D,                  \n        PROS_KEY_EFFT_I,               \n        PROS_KEY_EXPY_I,               \n        BKDT_PROS_KEY_I\n    FROM source_data\n)\n\nSELECT * FROM final",
  "metadata": {
    "models_used": [
      "claude-4-sonnet",
      "snowflake-llama-3.3-70b"
    ],
    "preferred_model": "claude-4-sonnet",
    "quality_score": 1.0,
    "dbt_features": [
      "config",
      "variables",
      "sources",
      "macros",
      "jinja_variables",
      "pre_hooks",
      "post_hooks",
      "tags"
    ],
    "total_time_ms": 32827,
    "comparison_notes": [
      "Selected claude-4-sonnet as preferred model",
      "claude-4-sonnet: Quality=1.000, Features=8, Time=25286ms",
      "snowflake-llama-3.3-70b: Quality=0.910, Features=8, Time=7533ms"
    ],
    "migration_notes": [
      "Organized logic using CTEs for better readability",
      "Added DBT configuration for materialization and metadata",
      "Used DBT variables for environment-specific configuration",
      "Converted from procedural BTEQ to declarative DBT model"
    ]
  },
  "warnings": [
    "Uses SELECT * - consider explicit column selection"
  ],
  "execution_time_ms": 32827
}