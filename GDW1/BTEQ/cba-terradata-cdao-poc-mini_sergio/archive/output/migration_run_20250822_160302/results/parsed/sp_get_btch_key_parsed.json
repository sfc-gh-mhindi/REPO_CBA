{
  "sql_blocks": [
    {
      "sql": "Select\n  (CAST(%%INDATE%% as date format'yyyymmdd'))(CHAR(8))\n;\n\n.SET FORMAT OFF",
      "start_line": 47,
      "end_line": 52,
      "snowflake_sql": "Select\n  (CAST(%%INDATE%% as date format'yyyymmdd'))(CHAR(8))\n;\n\n.SET FORMAT OFF",
      "error": null,
      "metadata": {
        "tables": [],
        "columns": [],
        "functions": [],
        "window_functions": []
      },
      "complexity_metrics": {
        "total_nodes": 0,
        "select_count": 0,
        "join_count": 0,
        "subquery_count": 0,
        "where_conditions": 0,
        "case_statements": 0,
        "window_functions": 0,
        "aggregate_functions": 0
      },
      "teradata_features": [
        "Variable substitution"
      ],
      "syntax_validation": {
        "valid": false,
        "error": "Expecting ). Line 2, Col: 49.\n  Select\n(CAST(%%INDATE%% as date format'yyyymmdd'))(CHAR\u001b[4m(\u001b[0m8))\n;\n.SET FORMAT OFF",
        "error_type": "ParseError"
      },
      "optimized_sql": "Select\n  (CAST(%%INDATE%% as date format'yyyymmdd'))(CHAR(8))\n;\n\n.SET FORMAT OFF"
    }
  ],
  "controls": [
    {
      "type": "RUN",
      "raw": ".RUN FILE=${ETL_APP_BTEQ}/bteq_login.sql",
      "args": null,
      "line_no": 1
    },
    {
      "type": "IF_ERRORCODE",
      "raw": ".IF ERRORCODE <> 0    THEN .GOTO EXITERR",
      "args": null,
      "line_no": 2
    },
    {
      "type": "EXPORT",
      "raw": ".EXPORT RESET",
      "args": null,
      "line_no": 23
    },
    {
      "type": "OS_CMD",
      "raw": ".OS rm /cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_BTCH_KEY.txt",
      "args": null,
      "line_no": 26
    },
    {
      "type": "EXPORT",
      "raw": ".EXPORT DATA FILE=/cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_BTCH_KEY.txt",
      "args": null,
      "line_no": 28
    },
    {
      "type": "CALL_SP",
      "raw": "CALL STAR_CAD_PROD_MACRO.SP_GET_BTCH_KEY(     \n  'DERIVED_ACCOUNT_PARTY'\n  ,CAST(%%INDATE%% as date format'yyyymmdd')",
      "args": null,
      "line_no": 32
    },
    {
      "type": "EXPORT",
      "raw": ".EXPORT RESET",
      "args": null,
      "line_no": 41
    },
    {
      "type": "OS_CMD",
      "raw": ".OS rm /cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_DATE.txt",
      "args": null,
      "line_no": 44
    },
    {
      "type": "EXPORT",
      "raw": ".EXPORT DATA FILE=/cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_DATE.txt",
      "args": null,
      "line_no": 46
    },
    {
      "type": "IF_ERRORCODE",
      "raw": ".IF ERRORCODE <> 0    THEN .GOTO EXITERR",
      "args": null,
      "line_no": 53
    },
    {
      "type": "LOGOFF",
      "raw": ".LOGOFF",
      "args": null,
      "line_no": 56
    },
    {
      "type": "LABEL",
      "raw": ".LABEL EXITERR",
      "args": null,
      "line_no": 58
    },
    {
      "type": "LOGOFF",
      "raw": ".LOGOFF",
      "args": null,
      "line_no": 60
    }
  ],
  "errors": []
}