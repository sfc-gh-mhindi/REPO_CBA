# DERV_ACCT_PATY_01_SP_GET_BTCH_KEY.sql - BTEQ Analysis

## File Overview
- **File Name**: DERV_ACCT_PATY_01_SP_GET_BTCH_KEY.sql
- **Analysis Status**: âœ… Success
- **Control Statements**: 12
- **SQL Blocks**: 0

## Control Flow Analysis

| Line | Type | Statement |
|------|------|-----------|
| 1 | RUN | `.RUN FILE=${ETL_APP_BTEQ}/bteq_login.sql` |
| 2 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 28 | EXPORT | `.EXPORT RESET` |
| 31 | OS_CMD | `.OS rm /cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_BTCH_KEY.txt` |
| 33 | EXPORT | `.EXPORT DATA FILE=/cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_BTCH_KEY.txt` |
| 40 | IMPORT | `.IMPORT VARTEXT FILE=/cba_app/CBMGDW/PROD/schedule/DERV_ACCT_PATY_extr_date.txt` |
| 43 | CALL_SP | `CALL STAR_CAD_PROD_MACRO.SP_GET_BTCH_KEY(     
  'DERIVED_ACCOUNT_PARTY'
  ,CAST...` |
| 52 | EXPORT | `.EXPORT RESET` |
| 54 | IF_ERRORCODE | `.IF ERRORCODE <> 0    THEN .GOTO EXITERR` |
| 57 | LOGOFF | `.LOGOFF` |
| 59 | LABEL | `.LABEL EXITERR` |
| 61 | LOGOFF | `.LOGOFF` |
## Migration Recommendations

### Suggested Migration Strategy
**dbt Macro** - Based on complexity score (0) and SQL patterns

### DCF Mapping
- **Error Handling**: Convert `.IF ERRORCODE` patterns to DCF error handling macros
- **File Operations**: Replace IMPORT/EXPORT with dbt seeds or external tables
- **Statistics**: Replace COLLECT STATS with Snowflake post-hooks
- **Stored Procedures**: Map CALL statements to DCF stored procedure macros

---

*Generated by BTEQ Parser Service - 2025-08-22 16:03:09*
