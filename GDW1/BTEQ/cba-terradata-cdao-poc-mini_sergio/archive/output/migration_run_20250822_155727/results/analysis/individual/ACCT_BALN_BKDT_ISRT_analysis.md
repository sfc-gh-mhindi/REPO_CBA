# ACCT_BALN_BKDT_ISRT.sql - BTEQ Analysis

## File Overview
- **File Name**: ACCT_BALN_BKDT_ISRT.sql
- **Analysis Status**: ‚úÖ Success
- **Control Statements**: 6
- **SQL Blocks**: 1

## Control Flow Analysis

| Line | Type | Statement |
|------|------|-----------|
| 1 | RUN | `.RUN FILE=%%BTEQ_LOGON_SCRIPT%%` |
| 2 | IF_ERRORCODE | `.IF ERRORCODE <> 0 THEN .GOTO EXITERR` |
| 58 | IF_ERRORCODE | `.IF ERRORCODE <> 0 THEN .GOTO EXITERR` |
| 61 | LOGOFF | `.LOGOFF` |
| 64 | LABEL | `.LABEL EXITERR` |
| 66 | LOGOFF | `.LOGOFF` |

## SQL Blocks Analysis

### SQL Block 1 (Lines 23-57)
- **Complexity Score**: 52
- **Has Valid SQL**: ‚úÖ
- **Conversion Successful**: ‚úÖ
- **Syntax Validation**: ‚úÖ Valid
- **Teradata Features**: 1

#### üìù Original Teradata SQL:
```sql
INSERT INTO %%CAD_PROD_DATA%%.ACCT_BALN_BKDT
(
ACCT_I,                        
BALN_TYPE_C,                   
CALC_FUNC_C,                   
TIME_PERD_C,                   
BALN_A,                        
CALC_F,                        
SRCE_SYST_C,                   
ORIG_SRCE_SYST_C,              
LOAD_D,                        
BKDT_EFFT_D,                   
BKDT_EXPY_D,                  
PROS_KEY_EFFT_I,               
PROS_KEY_EXPY_I,               
BKDT_PROS_KEY_I
)
SELECT 
ACCT_I,                        
BALN_TYPE_C,                   
CALC_FUNC_C,                   
TIME_PERD_C,                   
BALN_A,                        
CALC_F,                        
SRCE_SYST_C,                   
ORIG_SRCE_SYST_C,              
LOAD_D,                        
BKDT_EFFT_D,                   
BKDT_EXPY_D,                  
PROS_KEY_EFFT_I,               
PROS_KEY_EXPY_I,               
BKDT_PROS_KEY_I
FROM
%%DDSTG%%.ACCT_BALN_BKDT_STG2;
```

#### ‚ùÑÔ∏è Converted Snowflake SQL:
```sql
INSERT INTO %%CAD_PROD_DATA%%.ACCT_BALN_BKDT (ACCT_I, BALN_TYPE_C, CALC_FUNC_C, TIME_PERD_C, BALN_A, CALC_F, SRCE_SYST_C, ORIG_SRCE_SYST_C, LOAD_D, BKDT_EFFT_D, BKDT_EXPY_D, PROS_KEY_EFFT_I, PROS_KEY_EXPY_I, BKDT_PROS_KEY_I) SELECT ACCT_I, BALN_TYPE_C, CALC_FUNC_C, TIME_PERD_C, BALN_A, CALC_F, SRCE_SYST_C, ORIG_SRCE_SYST_C, LOAD_D, BKDT_EFFT_D, BKDT_EXPY_D, PROS_KEY_EFFT_I, PROS_KEY_EXPY_I, BKDT_PROS_KEY_I FROM %%DDSTG%%.ACCT_BALN_BKDT_STG2
```

#### üîç Syntax Validation Details:
- **Valid**: ‚úÖ

#### üéØ Teradata Features Detected:
- Variable substitution

#### ‚ö° Optimized SQL:
```sql
INSERT INTO "%%cad_prod_data%%"."acct_baln_bkdt" (
  "acct_i",
  "baln_type_c",
  "calc_func_c",
  "time_perd_c",
  "baln_a",
  "calc_f",
  "srce_syst_c",
  "orig_srce_syst_c",
  "load_d",
  "bkdt_efft_d",
  "bkdt_expy_d",
  "pros_key_efft_i",
  "pros_key_expy_i",
  "bkdt_pros_key_i"
)
SELECT
  "acct_baln_bkdt_stg2"."acct_i" AS "acct_i",
  "acct_baln_bkdt_stg2"."baln_type_c" AS "baln_type_c",
  "acct_baln_bkdt_stg2"."calc_func_c" AS "calc_func_c",
  "acct_baln_bkdt_stg2"."time_perd_c" AS "time_perd_c",
  "acct_baln_bkdt_stg2"."baln_a" AS "baln_a",
  "acct_baln_bkdt_stg2"."calc_f" AS "calc_f",
  "acct_baln_bkdt_stg2"."srce_syst_c" AS "srce_syst_c",
  "acct_baln_bkdt_stg2"."orig_srce_syst_c" AS "orig_srce_syst_c",
  "acct_baln_bkdt_stg2"."load_d" AS "load_d",
  "acct_baln_bkdt_stg2"."bkdt_efft_d" AS "bkdt_efft_d",
  "acct_baln_bkdt_stg2"."bkdt_expy_d" AS "bkdt_expy_d",
  "acct_baln_bkdt_stg2"."pros_key_efft_i" AS "pros_key_efft_i",
  "acct_baln_bkdt_stg2"."pros_key_expy_i" AS "pros_key_expy_i",
  "acct_baln_bkdt_stg2"."bkdt_pros_key_i" AS "bkdt_pros_key_i"
FROM "%%ddstg%%"."acct_baln_bkdt_stg2" AS "acct_baln_bkdt_stg2"
```

#### üìä SQL Metadata:
- **Tables**: ACCT_BALN_BKDT_STG2, ACCT_BALN_BKDT
- **Columns**: BKDT_PROS_KEY_I, BALN_A, BKDT_EXPY_D, BALN_TYPE_C, LOAD_D, SRCE_SYST_C, TIME_PERD_C, PROS_KEY_EXPY_I, CALC_FUNC_C, ACCT_I, BKDT_EFFT_D, CALC_F, PROS_KEY_EFFT_I, ORIG_SRCE_SYST_C

## Migration Recommendations

### Suggested Migration Strategy
**Incremental Model** - Based on complexity score (52) and SQL patterns

### DCF Mapping
- **Error Handling**: Convert `.IF ERRORCODE` patterns to DCF error handling macros
- **File Operations**: Replace IMPORT/EXPORT with dbt seeds or external tables
- **Statistics**: Replace COLLECT STATS with Snowflake post-hooks
- **Stored Procedures**: Map CALL statements to DCF stored procedure macros

---

*Generated by BTEQ Parser Service - 2025-08-22 15:57:30*
