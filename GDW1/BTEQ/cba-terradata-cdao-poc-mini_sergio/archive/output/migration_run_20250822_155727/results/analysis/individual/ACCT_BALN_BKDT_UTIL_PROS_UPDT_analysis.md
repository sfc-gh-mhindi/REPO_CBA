# ACCT_BALN_BKDT_UTIL_PROS_UPDT.sql - BTEQ Analysis

## File Overview
- **File Name**: ACCT_BALN_BKDT_UTIL_PROS_UPDT.sql
- **Analysis Status**: ‚úÖ Success
- **Control Statements**: 6
- **SQL Blocks**: 1

## Control Flow Analysis

| Line | Type | Statement |
|------|------|-----------|
| 1 | RUN | ` .RUN FILE=%%BTEQ_LOGON_SCRIPT%%` |
| 2 | IF_ERRORCODE | `.IF ERRORCODE <> 0 THEN .GOTO EXITERR` |
| 39 | IF_ERRORCODE | `.IF ERRORCODE <> 0 THEN .GOTO EXITERR` |
| 42 | LOGOFF | `.LOGOFF` |
| 45 | LABEL | `.LABEL EXITERR` |
| 47 | LOGOFF | `.LOGOFF` |

## SQL Blocks Analysis

### SQL Block 1 (Lines 22-38)
- **Complexity Score**: 0
- **Has Valid SQL**: ‚úÖ
- **Conversion Successful**: ‚úÖ
- **Syntax Validation**: ‚ùå Invalid
- **Teradata Features**: 1

#### üìù Original Teradata SQL:
```sql
UPDATE %%CAD_PROD_DATA%%.UTIL_PROS_ISAC
FROM
(SELECT COUNT(*) FROM 
%%DDSTG%%.ACCT_BALN_BKDT_STG2)A(INS_CNT),
(SELECT COUNT(*) FROM 
%%DDSTG%%.ACCT_BALN_BKDT_STG1)B(DEL_CNT)
SET  
        COMT_F = 'Y',
	SUCC_F = 'Y',
	COMT_S = CURRENT_TIMESTAMP(0),
	SYST_INS_Q = A.INS_CNT,
	SYST_DEL_Q = B.DEL_CNT
WHERE 
CONV_M='CAD_X01_ACCT_BALN_BKDT'
AND PROS_KEY_I = (SELECT MAX(PROS_KEY_I) FROM %%VTECH%%.UTIL_PROS_ISAC 
WHERE CONV_M='CAD_X01_ACCT_BALN_BKDT');
```

#### ‚ùÑÔ∏è Converted Snowflake SQL:
```sql
UPDATE %%CAD_PROD_DATA%%.UTIL_PROS_ISAC
FROM
(SELECT COUNT(*) FROM 
%%DDSTG%%.ACCT_BALN_BKDT_STG2)A(INS_CNT),
(SELECT COUNT(*) FROM 
%%DDSTG%%.ACCT_BALN_BKDT_STG1)B(DEL_CNT)
SET  
        COMT_F = 'Y',
	SUCC_F = 'Y',
	COMT_S = CURRENT_TIMESTAMP(0),
	SYST_INS_Q = A.INS_CNT,
	SYST_DEL_Q = B.DEL_CNT
WHERE 
CONV_M='CAD_X01_ACCT_BALN_BKDT'
AND PROS_KEY_I = (SELECT MAX(PROS_KEY_I) FROM %%VTECH%%.UTIL_PROS_ISAC 
WHERE CONV_M='CAD_X01_ACCT_BALN_BKDT');
```

#### üîç Syntax Validation Details:
- **Valid**: ‚ùå

#### üéØ Teradata Features Detected:
- Variable substitution

#### ‚ö° Optimized SQL:
```sql
UPDATE %%CAD_PROD_DATA%%.UTIL_PROS_ISAC
FROM
(SELECT COUNT(*) FROM 
%%DDSTG%%.ACCT_BALN_BKDT_STG2)A(INS_CNT),
(SELECT COUNT(*) FROM 
%%DDSTG%%.ACCT_BALN_BKDT_STG1)B(DEL_CNT)
SET  
        COMT_F = 'Y',
	SUCC_F = 'Y',
	COMT_S = CURRENT_TIMESTAMP(0),
	SYST_INS_Q = A.INS_CNT,
	SYST_DEL_Q = B.DEL_CNT
WHERE 
CONV_M='CAD_X01_ACCT_BALN_BKDT'
AND PROS_KEY_I = (SELECT MAX(PROS_KEY_I) FROM %%VTECH%%.UTIL_PROS_ISAC 
WHERE CONV_M='CAD_X01_ACCT_BALN_BKDT');
```

#### üìä SQL Metadata:

## Migration Recommendations

### Suggested Migration Strategy
**Simple Model** - Based on complexity score (0) and SQL patterns

### DCF Mapping
- **Error Handling**: Convert `.IF ERRORCODE` patterns to DCF error handling macros
- **File Operations**: Replace IMPORT/EXPORT with dbt seeds or external tables
- **Statistics**: Replace COLLECT STATS with Snowflake post-hooks
- **Stored Procedures**: Map CALL statements to DCF stored procedure macros

---

*Generated by BTEQ Parser Service - 2025-08-22 15:57:33*
