{
  "sql_blocks": [
    {
      "sql": "UPDATE STAR_CAD_PROD_DATA.UTIL_PROS_ISAC\nFROM\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG2)A(INS_CNT),\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG1)B(DEL_CNT)\nSET  \n        COMT_F = 'Y',\n\tSUCC_F = 'Y',\n\tCOMT_S = CURRENT_TIMESTAMP(0),\n\tSYST_INS_Q = A.INS_CNT,\n\tSYST_DEL_Q = B.DEL_CNT\nWHERE \nCONV_M='CAD_X01_ACCT_BALN_BKDT'\nAND PROS_KEY_I = (SELECT MAX(PROS_KEY_I) FROM PVTECH.UTIL_PROS_ISAC \nWHERE CONV_M='CAD_X01_ACCT_BALN_BKDT');",
      "start_line": 22,
      "end_line": 38,
      "snowflake_sql": "UPDATE STAR_CAD_PROD_DATA.UTIL_PROS_ISAC\nFROM\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG2)A(INS_CNT),\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG1)B(DEL_CNT)\nSET  \n        COMT_F = 'Y',\n\tSUCC_F = 'Y',\n\tCOMT_S = CURRENT_TIMESTAMP(0),\n\tSYST_INS_Q = A.INS_CNT,\n\tSYST_DEL_Q = B.DEL_CNT\nWHERE \nCONV_M='CAD_X01_ACCT_BALN_BKDT'\nAND PROS_KEY_I = (SELECT MAX(PROS_KEY_I) FROM PVTECH.UTIL_PROS_ISAC \nWHERE CONV_M='CAD_X01_ACCT_BALN_BKDT');",
      "error": null,
      "metadata": {
        "tables": [],
        "columns": [],
        "functions": [],
        "window_functions": []
      },
      "complexity_metrics": {
        "total_nodes": 0,
        "select_count": 0,
        "join_count": 0,
        "subquery_count": 0,
        "where_conditions": 0,
        "case_statements": 0,
        "window_functions": 0,
        "aggregate_functions": 0
      },
      "teradata_features": [],
      "syntax_validation": {
        "valid": false,
        "error": "Required keyword: 'expressions' missing for <class 'sqlglot.expressions.Update'>. Line 4, Col: 38.\n   STAR_CAD_PROD_DATA.UTIL_PROS_ISAC\nFROM\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG2)A(INS_CNT)\u001b[4m,\u001b[0m\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG1)B(DEL_CNT)\nSET  \nCOMT_F = 'Y',\nSUCC_F = 'Y',\nCOMT",
        "error_type": "ParseError"
      },
      "optimized_sql": "UPDATE STAR_CAD_PROD_DATA.UTIL_PROS_ISAC\nFROM\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG2)A(INS_CNT),\n(SELECT COUNT(*) FROM \nPDDSTG.ACCT_BALN_BKDT_STG1)B(DEL_CNT)\nSET  \n        COMT_F = 'Y',\n\tSUCC_F = 'Y',\n\tCOMT_S = CURRENT_TIMESTAMP(0),\n\tSYST_INS_Q = A.INS_CNT,\n\tSYST_DEL_Q = B.DEL_CNT\nWHERE \nCONV_M='CAD_X01_ACCT_BALN_BKDT'\nAND PROS_KEY_I = (SELECT MAX(PROS_KEY_I) FROM PVTECH.UTIL_PROS_ISAC \nWHERE CONV_M='CAD_X01_ACCT_BALN_BKDT');"
    }
  ],
  "controls": [
    {
      "type": "RUN",
      "raw": " .RUN FILE=${ETL_APP_BTEQ}/bteq_login.sql",
      "args": null,
      "line_no": 1
    },
    {
      "type": "IF_ERRORCODE",
      "raw": ".IF ERRORCODE <> 0 THEN .GOTO EXITERR",
      "args": null,
      "line_no": 2
    },
    {
      "type": "IF_ERRORCODE",
      "raw": ".IF ERRORCODE <> 0 THEN .GOTO EXITERR",
      "args": null,
      "line_no": 39
    },
    {
      "type": "LOGOFF",
      "raw": ".LOGOFF",
      "args": null,
      "line_no": 42
    },
    {
      "type": "LABEL",
      "raw": ".LABEL EXITERR",
      "args": null,
      "line_no": 45
    },
    {
      "type": "LOGOFF",
      "raw": ".LOGOFF",
      "args": null,
      "line_no": 47
    }
  ],
  "errors": []
}