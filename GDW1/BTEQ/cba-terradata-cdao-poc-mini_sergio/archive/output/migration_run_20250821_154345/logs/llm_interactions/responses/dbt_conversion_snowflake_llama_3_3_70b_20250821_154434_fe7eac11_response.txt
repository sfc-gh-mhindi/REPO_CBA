# LLM Response
Interaction ID: 20250821_154434_fe7eac11
Success: True
Processing Time: 4586ms
Quality Score: None

# Response
```sql
{%- set process_name = 'ACCT_BALN_BKDT_AVG_CALL' -%}
{%- set stream_name = 'ACCT_BALN_BKDT_AVG_CALL_STREAM' -%}

{{
  config(
    materialized='table',
    database=var('target_database'),
    schema='target_schema',
    tags=['account_balance', 'average_calculation'],
    pre_hook=[
        "{{ log_dcf_exec_msg('ACCT_BALN_BKDT_AVG_CALL process started') }}"
    ],
    post_hook=[
        "{{ log_dcf_exec_msg('ACCT_BALN_BKDT_AVG_CALL process ended') }}"
    ]
  )
}}

/*
    Model Documentation
    Purpose: Calculate the Monthly Average balance.
    Business Logic: This model sources from ACCT BALN BKDT and calls the SP_CALC_AVRG_DAY_BALN_BKDT stored procedure.
    Dependencies: ACCT_BALN_BKDT table, SP_CALC_AVRG_DAY_BALN_BKDT stored procedure
*/

WITH calculation_date AS (
    SELECT CAST(ADD_MONTHS(CURRENT_DATE, -1) AS DATE) AS calculation_date
),

final AS (
    SELECT 
        -- Call the stored procedure with the calculated date
        SP_CALC_AVRG_DAY_BALN_BKDT(calculation_date) AS result
    FROM calculation_date
)

SELECT * FROM final
```