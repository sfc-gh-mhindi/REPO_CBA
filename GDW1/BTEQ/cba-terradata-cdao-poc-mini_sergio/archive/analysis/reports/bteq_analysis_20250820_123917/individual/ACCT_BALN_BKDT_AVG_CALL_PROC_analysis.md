# ACCT_BALN_BKDT_AVG_CALL_PROC.sql - BTEQ Analysis

## File Overview
- **File Name**: ACCT_BALN_BKDT_AVG_CALL_PROC.sql
- **Analysis Status**: âœ… Success
- **Control Statements**: 7
- **SQL Blocks**: 0

## Control Flow Analysis

| Line | Type | Statement |
|------|------|-----------|
| 1 | RUN | `.RUN FILE=%%BTEQ_LOGON_SCRIPT%%` |
| 2 | IF_ERRORCODE | `.IF ERRORCODE <> 0 THEN .GOTO EXITERR` |
| 24 | CALL_SP | `CALL %%CAD_PROD_MACRO%%.SP_CALC_AVRG_DAY_BALN_BKDT (
CAST(ADD_MONTHS(CURRENT_DAT...` |
| 27 | IF_ERRORCODE | `.IF ERRORCODE <> 0 THEN .GOTO EXITERR` |
| 30 | LOGOFF | `.LOGOFF` |
| 32 | LABEL | `.LABEL EXITERR` |
| 34 | LOGOFF | `.LOGOFF` |
## Migration Recommendations

### Suggested Migration Strategy
**Control-only script** - Convert to dbt macro or pre/post-hook

### DCF Mapping
- **Error Handling**: Convert `.IF ERRORCODE` patterns to DCF error handling macros
- **File Operations**: Replace IMPORT/EXPORT with dbt seeds or external tables
- **Statistics**: Replace COLLECT STATS with Snowflake post-hooks
- **Stored Procedures**: Map CALL statements to DCF stored procedure macros

---

*Generated by BTEQ Parser Service - 2025-08-20 12:39:18*
