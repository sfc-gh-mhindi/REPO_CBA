# Table Mapping Summary for CBA Missing Tables Count Queries

This document provides a complete mapping of all Snowflake Iceberg tables to their Teradata counterparts for count validation.

## Table Mappings (46 tables total)

| # | Snowflake Table | Teradata Counterpart | File Name |
|---|---|---|---|
| 1 | PS_CLD_RW.PDGRD.GRD_RPRT_CALR_CLYR | PDGRD.GRD_RPRT_CALR_CLYR | 01_GRD_RPRT_CALR_CLYR_count.sql |
| 2 | PS_CLD_RW.STARCADPRODDATA.ACCT_BALN_ADJ | STARCADPRODDATA.ACCT_BALN_ADJ | 02_ACCT_BALN_ADJ_count.sql |
| 3 | PS_CLD_RW.PDCBODS.ACCT_MSTR_CYT_DATA | PDCBODS.ACCT_MSTR_CYT_DATA | 03_ACCT_MSTR_CYT_DATA_count.sql |
| 4 | PS_CLD_RW.PDCBODS.BUSN_PTNR | PDCBODS.BUSN_PTNR | 04_BUSN_PTNR_count.sql |
| 5 | PS_CLD_RW.PDCBODS.CBA_FNCL_SERV_GL_DATA | PDCBODS.CBA_FNCL_SERV_GL_DATA | 05_CBA_FNCL_SERV_GL_DATA_count.sql |
| 6 | PS_CLD_RW.PDCBODS.MSTR_CNCT_BALN_TRNF_PRTP | PDCBODS.MSTR_CNCT_BALN_TRNF_PRTP | 06_MSTR_CNCT_BALN_TRNF_PRTP_count.sql |
| 7 | PS_CLD_RW.PDCBODS.MSTR_CNCT_MSTR_DATA_GENL | PDCBODS.MSTR_CNCT_MSTR_DATA_GENL | 07_MSTR_CNCT_MSTR_DATA_GENL_count.sql |
| 8 | PS_CLD_RW.PDCBODS.MSTR_CNCT_PRXY_ACCT | PDCBODS.MSTR_CNCT_PRXY_ACCT | 08_MSTR_CNCT_PRXY_ACCT_count.sql |
| 9 | PS_CLD_RW.PDSECURITY.ROW_LEVL_SECU_USER_PRFL | PDSECURITY.ROW_LEVL_SECU_USER_PRFL | 09_ROW_LEVL_SECU_USER_PRFL_count.sql |
| 10 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_PATY_PSST | STARCADPRODDATA.DERV_PRTF_PATY_PSST | 10_DERV_PRTF_PATY_PSST_count.sql |
| 11 | PS_CLD_RW.PDGRD.GRD_RPRT_CALR_FNYR | PDGRD.GRD_RPRT_CALR_FNYR | 11_GRD_RPRT_CALR_FNYR_count.sql |
| 12 | PS_CLD_RW.STARCADPRODDATA.MAP_SAP_INVL_PDCT | STARCADPRODDATA.MAP_SAP_INVL_PDCT | 12_MAP_SAP_INVL_PDCT_count.sql |
| 13 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_ACCT_REL | STARCADPRODDATA.DERV_PRTF_ACCT_REL | 13_DERV_PRTF_ACCT_REL_count.sql |
| 14 | PS_CLD_RW.STARCADPRODDATA.ACCT_PDCT | STARCADPRODDATA.ACCT_PDCT | 14_ACCT_PDCT_count.sql |
| 15 | PS_CLD_RW.PDPATY.ACCT_PATY | PDPATY.ACCT_PATY | 15_ACCT_PATY_count.sql |
| 16 | PS_CLD_RW.STARCADPRODDATA.ACCT_OFFR | STARCADPRODDATA.ACCT_OFFR | 16_ACCT_OFFR_count.sql |
| 17 | PS_CLD_RW.STARCADPRODDATA.ACCT_BASE | STARCADPRODDATA.ACCT_BASE | 17_ACCT_BASE_count.sql |
| 18 | PS_CLD_RW.PDDSTG.ACCT_BALN_BKDT_ADJ_RULE | PDDSTG.ACCT_BALN_BKDT_ADJ_RULE | 18_ACCT_BALN_BKDT_ADJ_RULE_count.sql |
| 19 | PS_CLD_RW.PDGRD.GRD_PRTF_TYPE_ENHC_HIST_PSST | DGRDDB.GRD_PRTF_TYPE_ENHC_HIST_PSST | 19_GRD_PRTF_TYPE_ENHC_HIST_PSST_count.sql |
| 20 | PS_CLD_RW.PDGRD.GRD_PRTF_TYPE_ENHC_PSST | DGRDDB.GRD_PRTF_TYPE_ENHC_PSST | 20_GRD_PRTF_TYPE_ENHC_PSST_count.sql |
| 21 | PS_CLD_RW.PDDSTG.ACCT_BALN_BKDT_STG1 | PDDSTG.ACCT_BALN_BKDT_STG1 | 21_ACCT_BALN_BKDT_STG1_count.sql |
| 22 | PS_CLD_RW.PDDSTG.ACCT_BALN_BKDT_STG2 | PDDSTG.ACCT_BALN_BKDT_STG2 | 22_ACCT_BALN_BKDT_STG2_count.sql |
| 23 | PS_CLD_RW.PDCBSTG.ACCT_REL_HLS_REME | PDDSTG.ACCT_REL_HLS_REME | 23_ACCT_REL_HLS_REME_count.sql |
| 24 | PS_CLD_RW.PDCBSTG.ACCT_REL_HLS_REME_HIST | PDDSTG.ACCT_REL_HLS_REME_HIST | 24_ACCT_REL_HLS_REME_HIST_count.sql |
| 25 | PS_CLD_RW.PDCBSTG.UTIL_PROS_SAP_RUN | PDDSTG.UTIL_PROS_SAP_RUN | 25_UTIL_PROS_SAP_RUN_count.sql |
| 26 | PS_CLD_RW.STARCADPRODDATA.ACCT_BALN_BKDT | PVTECH.ACCT_BALN_BKDT | 26_ACCT_BALN_BKDT_count.sql |
| 27 | PS_CLD_RW.STARCADPRODDATA.ACCT_BALN_BKDT_RECN | PVTECH.ACCT_BALN_BKDT_RECN | 27_ACCT_BALN_BKDT_RECN_count.sql |
| 28 | PS_CLD_RW.STARCADPRODDATA.ACCT_BALN_BKDT_AUDT | STAR_CAD_PROD_DATA.ACCT_BALN_BKDT_AUDT | 28_ACCT_BALN_BKDT_AUDT_count.sql |
| 29 | PS_CLD_RW.PP01STARCADPRODDATA.ACCT_INT_GRUP | PVTECH.ACCT_INT_GRUP | 29_ACCT_INT_GRUP_PP01_count.sql |
| 30 | PS_CLD_RW.STARCADPRODDATA.ACCT_INT_GRUP | PVTECH.ACCT_INT_GRUP | 30_ACCT_INT_GRUP_count.sql |
| 31 | PS_CLD_RW.UDTDWRK.DERV_PRTF_ACCT_HIST_PSST | PVTECH.DERV_PRTF_ACCT_HIST_PSST | 31_DERV_PRTF_ACCT_HIST_PSST_UDTDWRK_count.sql |
| 32 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_ACCT_HIST_PSST | PVTECH.DERV_PRTF_ACCT_HIST_PSST | 32_DERV_PRTF_ACCT_HIST_PSST_count.sql |
| 33 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_ACCT_INT_GRUP_PSST | PVTECH.DERV_PRTF_ACCT_INT_GRUP_PSST | 33_DERV_PRTF_ACCT_INT_GRUP_PSST_count.sql |
| 34 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_ACCT_PSST | PVTECH.DERV_PRTF_ACCT_PSST | 34_DERV_PRTF_ACCT_PSST_count.sql |
| 35 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_INT_GRUP_ENHC_PSST | PVTECH.DERV_PRTF_INT_GRUP_ENHC_PSST | 35_DERV_PRTF_INT_GRUP_ENHC_PSST_count.sql |
| 36 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_INT_GRUP_OWN_PSST | PVTECH.DERV_PRTF_INT_GRUP_OWN_PSST | 36_DERV_PRTF_INT_GRUP_OWN_PSST_count.sql |
| 37 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_INT_HIST_PSST | PVTECH.DERV_PRTF_INT_HIST_PSST | 37_DERV_PRTF_INT_HIST_PSST_count.sql |
| 38 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_INT_PSST | PVTECH.DERV_PRTF_INT_PSST | 38_DERV_PRTF_INT_PSST_STARCADPRODDATA_count.sql |
| 39 | PS_CLD_RW.PTEMP.DERV_PRTF_INT_PSST | PVTECH.DERV_PRTF_INT_PSST | 39_DERV_PRTF_INT_PSST_PTEMP_count.sql |
| 40 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_OWN_HIST_PSST | PVTECH.DERV_PRTF_OWN_HIST_PSST | 40_DERV_PRTF_OWN_HIST_PSST_count.sql |
| 41 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_OWN_PSST | PVTECH.DERV_PRTF_OWN_PSST | 41_DERV_PRTF_OWN_PSST_count.sql |
| 42 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_PATY_HIST_PSST | PVTECH.DERV_PRTF_PATY_HIST_PSST | 42_DERV_PRTF_PATY_HIST_PSST_count.sql |
| 43 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_PATY_INT_GRUP_PSST | PVTECH.DERV_PRTF_PATY_INT_GRUP_PSST | 43_DERV_PRTF_PATY_INT_GRUP_PSST_count.sql |
| 44 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_ACCT_OWN_REL | STAR_CAD_PROD_DATA.DERV_PRTF_ACCT_OWN_REL | 44_DERV_PRTF_ACCT_OWN_REL_count.sql |
| 45 | PS_CLD_RW.STARCADPRODDATA.DERV_PRTF_PATY_OWN_REL | STAR_CAD_PROD_DATA.DERV_PRTF_PATY_OWN_REL | 45_DERV_PRTF_PATY_OWN_REL_count.sql |
| 46 | PS_CLD_RW.STARCADPRODDATA.ACCT_BALN | STARCADPRODDATA.ACCT_BALN | 46_ACCT_BALN_count.sql |

## Notes

1. **Multiple Target Schemas**: Note that some Teradata tables map to multiple Snowflake schemas (e.g., PVTECH.ACCT_INT_GRUP maps to both PP01STARCADPRODDATA and STARCADPRODDATA)

2. **Schema Mappings**: The main schema mappings are:
   - PVTECH → STARCADPRODDATA, PP01STARCADPRODDATA, PTEMP, UDTDWRK
   - DGRDDB → PDGRD
   - PDDSTG → PDCBSTG, PDDSTG
   - STAR_CAD_PROD_DATA → STARCADPRODDATA

3. **Validation Process**: Use these count queries to validate data completeness after migration by comparing the TD counts with the corresponding Snowflake table counts.

4. **Pre-execution Check**: Verify that all referenced Teradata tables exist and are accessible in your environment before running the count queries. 