@startuml CSEL_CCODS_Execution_Flow

!define CSEL_COLOR #E1F5FE
!define CCODS_COLOR #F3E5F5
!define SUCCESS_COLOR #C8E6C9
!define ERROR_COLOR #FFCDD2

title CSEL & CCODS Execution Flow

start

:CSEL Process Start;
note right: 3:00 AM Australia/Sydney

partition "CSEL (18 Steps)" CSEL_COLOR {
  :Step 1: Process Stream Status Check;
  :Step 2: Util Pros ISAC Prev Load Check;
  :Step 3: Load GDW Process Key Sequence;
  :Step 4: Load Mapping Lookups;
  :Step 5: Process Stream Finishing Point;
  :Step 6-18: Data Processing;
  note right
    • Extract Applications
    • Transform Data
    • Load to Temp Tables
    • Delta Processing
    • Load to GDW
  end note
}

if (CSEL Success?) then (yes)
  :CSEL Complete;
  note right SUCCESS_COLOR: All 18 steps completed
else (no)
  :CSEL Failed;
  note right ERROR_COLOR: Log error and stop
  stop
endif

:Wait 1 Hour Buffer;

:CCODS Process Start;
note right: 4:00 AM Australia/Sydney

partition "CCODS (2 Steps)" CCODS_COLOR {
  :Step 1: Transform BCFINSG Data;
  note right: models/ccods/40_transform/
  
  if (Transform Success?) then (yes)
    :Step 2: Load to GDW;
    note right: models/ccods/60_load_gdw/
  else (no)
    :Transform Failed;
    stop
  endif
}

if (CCODS Success?) then (yes)
  :CCODS Complete;
  note right SUCCESS_COLOR: PLAN_BALN_SEGM_MSTR populated
else (no)
  :CCODS Failed;
  note right ERROR_COLOR: Log error details
  stop
endif

:Both Processes Complete;
stop

@enduml 