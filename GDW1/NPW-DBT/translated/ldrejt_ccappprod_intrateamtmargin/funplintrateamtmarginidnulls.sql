{{ config(materialized='view', tags=['LdREJT_CcAppProd_IntRateAmtMargin']) }}

WITH FunPlIntrateAmtMarginIdNulls AS (
	SELECT
		PL_INT_RATE_ID as PL_INT_RATE_ID,
		PL_INT_RATE_PL_INT_RATE_ID as PL_INT_RATE_PL_INT_RATE_ID,
		PL_INT_RATE_DOC_SEQ_NO as PL_INT_RATE_DOC_SEQ_NO,
		PL_INT_RATE_CASS_MARGIN_AMT as PL_INT_RATE_CASS_MARGIN_AMT,
		PL_INT_RATE_INT_RATE_TERM as PL_INT_RATE_INT_RATE_TERM,
		PL_INT_RATE_INT_RATE_FREQ_ID as PL_INT_RATE_INT_RATE_FREQ_ID,
		PL_INT_RATE_VARIANT_CAT_ID as PL_INT_RATE_VARIANT_CAT_ID,
		PL_INT_RATE_USAGE_CAT_ID as PL_INT_RATE_USAGE_CAT_ID,
		PL_INT_RATE_PL_APP_PROD_ID as PL_INT_RATE_PL_APP_PROD_ID,
		PL_MARGIN_PL_MARGIN_ID as PL_MARGIN_PL_MARGIN_ID,
		PL_MARGIN_MARGIN_AMT as PL_MARGIN_MARGIN_AMT,
		PL_MARGIN_PL_FEE_ID as PL_MARGIN_PL_FEE_ID,
		PL_MARGIN_PL_INT_RATE_ID as PL_MARGIN_PL_INT_RATE_ID,
		PL_MARGIN_MARGIN_RESN_CAT_ID as PL_MARGIN_MARGIN_RESN_CAT_ID,
		PL_MARGIN_PL_APP_PROD_ID as PL_MARGIN_PL_APP_PROD_ID,
		PL_INT_RATE_AMT_INT_RTE_AMT_2 as PL_INT_RATE_AMT_INT_RTE_AMT_2,
		PL_INT_RATE_AMT_INT_RTCT_ID2 as PL_INT_RATE_AMT_INT_RTCT_ID2,
		PL_INT_RATE_AMT_PL_INT_RATE_ID as PL_INT_RATE_AMT_PL_INT_RATE_ID,
		PL_INT_RATE_AMT_INT_RATE_AMT_1 as PL_INT_RATE_AMT_INT_RATE_AMT_1,
		PL_INT_RATE_AMT_INT_RTCT_ID1 as PL_INT_RATE_AMT_INT_RTCT_ID1,
		PL_MARGIN_FOUND_FLAG as PL_MARGIN_FOUND_FLAG,
		PL_INT_RATE_FOUND_FLAG as PL_INT_RATE_FOUND_FLAG,
		PL_INT_RATE_AMT_FOUND_FLAG as PL_INT_RATE_AMT_FOUND_FLAG,
		ETL_D as ETL_D,
		ORIG_ETL_D as ORIG_ETL_D,
		EROR_C as EROR_C
	FROM {{ ref('RejPlIntRateIdNullsDS') }}
	UNION ALL
	SELECT
		PL_INT_RATE_ID,
		PL_INT_RATE_PL_INT_RATE_ID,
		PL_INT_RATE_DOC_SEQ_NO,
		PL_INT_RATE_CASS_MARGIN_AMT,
		PL_INT_RATE_INT_RATE_TERM,
		PL_INT_RATE_INT_RATE_FREQ_ID,
		PL_INT_RATE_VARIANT_CAT_ID,
		PL_INT_RATE_USAGE_CAT_ID,
		PL_INT_RATE_PL_APP_PROD_ID,
		PL_MARGIN_PL_MARGIN_ID,
		PL_MARGIN_MARGIN_AMT,
		PL_MARGIN_PL_FEE_ID,
		PL_MARGIN_PL_INT_RATE_ID,
		PL_MARGIN_MARGIN_RESN_CAT_ID,
		PL_MARGIN_PL_APP_PROD_ID,
		PL_INT_RATE_AMT_INT_RTE_AMT_2,
		PL_INT_RATE_AMT_INT_RTCT_ID2,
		PL_INT_RATE_AMT_PL_INT_RATE_ID,
		PL_INT_RATE_AMT_INT_RATE_AMT_1,
		PL_INT_RATE_AMT_INT_RTCT_ID1,
		PL_MARGIN_FOUND_FLAG,
		PL_INT_RATE_FOUND_FLAG,
		PL_INT_RATE_AMT_FOUND_FLAG,
		ETL_D,
		ORIG_ETL_D,
		EROR_C
	FROM {{ ref('TgtPlIntrateAmtMarginRejectsDS') }}
	UNION ALL
	SELECT
		PL_INT_RATE_ID,
		PL_INT_RATE_PL_INT_RATE_ID,
		PL_INT_RATE_DOC_SEQ_NO,
		PL_INT_RATE_CASS_MARGIN_AMT,
		PL_INT_RATE_INT_RATE_TERM,
		PL_INT_RATE_INT_RATE_FREQ_ID,
		PL_INT_RATE_VARIANT_CAT_ID,
		PL_INT_RATE_USAGE_CAT_ID,
		PL_INT_RATE_PL_APP_PROD_ID,
		PL_MARGIN_PL_MARGIN_ID,
		PL_MARGIN_MARGIN_AMT,
		PL_MARGIN_PL_FEE_ID,
		PL_MARGIN_PL_INT_RATE_ID,
		PL_MARGIN_MARGIN_RESN_CAT_ID,
		PL_MARGIN_PL_APP_PROD_ID,
		PL_INT_RATE_AMT_INT_RTE_AMT_2,
		PL_INT_RATE_AMT_INT_RTCT_ID2,
		PL_INT_RATE_AMT_PL_INT_RATE_ID,
		PL_INT_RATE_AMT_INT_RATE_AMT_1,
		PL_INT_RATE_AMT_INT_RTCT_ID1,
		PL_MARGIN_FOUND_FLAG,
		PL_INT_RATE_FOUND_FLAG,
		PL_INT_RATE_AMT_FOUND_FLAG,
		ETL_D,
		ORIG_ETL_D,
		EROR_C
	FROM {{ ref('RejtApptPdctFeatDS') }}
)

SELECT * FROM FunPlIntrateAmtMarginIdNulls