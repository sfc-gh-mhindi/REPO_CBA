{{ config(materialized='view', tags=['LdREJT_PL_FEE_PL_MARGIN']) }}

WITH FunJnlIdNulls AS (
	SELECT
		PL_FEE_ID as PL_FEE_ID,
		PL_APP_PROD_ID as PL_APP_PROD_ID,
		PL_FEE_PL_FEE_ID as PL_FEE_PL_FEE_ID,
		PL_FEE_ADD_TO_TOTAL_FLAG as PL_FEE_ADD_TO_TOTAL_FLAG,
		PL_FEE_FEE_AMT as PL_FEE_FEE_AMT,
		PL_FEE_BASE_FEE_AMT as PL_FEE_BASE_FEE_AMT,
		PL_FEE_PAY_FEE_AT_FUNDING_FLAG as PL_FEE_PAY_FEE_AT_FUNDING_FLAG,
		PL_FEE_START_DATE as PL_FEE_START_DATE,
		PL_FEE_PL_CAPITALIS_FEE_CAT_ID as PL_FEE_PL_CAPITALIS_FEE_CAT_ID,
		PL_FEE_FEE_SCREEN_DESC as PL_FEE_FEE_SCREEN_DESC,
		PL_FEE_FEE_DESC as PL_FEE_FEE_DESC,
		PL_FEE_CASS_FEE_CODE as PL_FEE_CASS_FEE_CODE,
		PL_FEE_CASS_FEE_KEY as PL_FEE_CASS_FEE_KEY,
		PL_FEE_TOTAL_FEE_AMT as PL_FEE_TOTAL_FEE_AMT,
		PL_FEE_PL_APP_PROD_ID as PL_FEE_PL_APP_PROD_ID,
		PL_MARGIN_PL_MARGIN_ID as PL_MARGIN_PL_MARGIN_ID,
		PL_MARGIN_MARGIN_AMT as PL_MARGIN_MARGIN_AMT,
		PL_MARGIN_PL_FEE_ID as PL_MARGIN_PL_FEE_ID,
		PL_MARGIN_PL_INT_RATE_ID as PL_MARGIN_PL_INT_RATE_ID,
		PL_MARGIN_MARGIN_REASON_CAT_ID as PL_MARGIN_MARGIN_REASON_CAT_ID,
		PL_MARGIN_PL_APP_PROD_ID as PL_MARGIN_PL_APP_PROD_ID,
		PL_FEE_FOUND_FLAG as PL_FEE_FOUND_FLAG,
		PL_MARGIN_FOUND_FLAG as PL_MARGIN_FOUND_FLAG,
		ETL_D as ETL_D,
		ORIG_ETL_D as ORIG_ETL_D,
		EROR_C as EROR_C
	FROM {{ ref('SrcPlFeeIdNullsDS') }}
	UNION ALL
	SELECT
		PL_FEE_ID,
		PL_APP_PROD_ID,
		PL_FEE_PL_FEE_ID,
		PL_FEE_ADD_TO_TOTAL_FLAG,
		PL_FEE_FEE_AMT,
		PL_FEE_BASE_FEE_AMT,
		PL_FEE_PAY_FEE_AT_FUNDING_FLAG,
		PL_FEE_START_DATE,
		PL_FEE_PL_CAPITALIS_FEE_CAT_ID,
		PL_FEE_FEE_SCREEN_DESC,
		PL_FEE_FEE_DESC,
		PL_FEE_CASS_FEE_CODE,
		PL_FEE_CASS_FEE_KEY,
		PL_FEE_TOTAL_FEE_AMT,
		PL_FEE_PL_APP_PROD_ID,
		PL_MARGIN_PL_MARGIN_ID,
		PL_MARGIN_MARGIN_AMT,
		PL_MARGIN_PL_FEE_ID,
		PL_MARGIN_PL_INT_RATE_ID,
		PL_MARGIN_MARGIN_REASON_CAT_ID,
		PL_MARGIN_PL_APP_PROD_ID,
		PL_FEE_FOUND_FLAG,
		PL_MARGIN_FOUND_FLAG,
		ETL_D,
		ORIG_ETL_D,
		EROR_C
	FROM {{ ref('TgtPlFeePlMarginRejectsDS') }}
	UNION ALL
	SELECT
		PL_FEE_ID,
		PL_APP_PROD_ID,
		PL_FEE_PL_FEE_ID,
		PL_FEE_ADD_TO_TOTAL_FLAG,
		PL_FEE_FEE_AMT,
		PL_FEE_BASE_FEE_AMT,
		PL_FEE_PAY_FEE_AT_FUNDING_FLAG,
		PL_FEE_START_DATE,
		PL_FEE_PL_CAPITALIS_FEE_CAT_ID,
		PL_FEE_FEE_SCREEN_DESC,
		PL_FEE_FEE_DESC,
		PL_FEE_CASS_FEE_CODE,
		PL_FEE_CASS_FEE_KEY,
		PL_FEE_TOTAL_FEE_AMT,
		PL_FEE_PL_APP_PROD_ID,
		PL_MARGIN_PL_MARGIN_ID,
		PL_MARGIN_MARGIN_AMT,
		PL_MARGIN_PL_FEE_ID,
		PL_MARGIN_PL_INT_RATE_ID,
		PL_MARGIN_MARGIN_REASON_CAT_ID,
		PL_MARGIN_PL_APP_PROD_ID,
		PL_FEE_FOUND_FLAG,
		PL_MARGIN_FOUND_FLAG,
		ETL_D,
		ORIG_ETL_D,
		EROR_C
	FROM {{ ref('SrcUpdateNotfoundDS') }}
)

SELECT * FROM FunJnlIdNulls