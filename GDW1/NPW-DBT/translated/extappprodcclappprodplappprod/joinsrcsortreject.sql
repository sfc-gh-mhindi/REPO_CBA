{{ config(materialized='view', tags=['ExtAppProdCclAppProdPlAppProd']) }}

WITH JoinSrcSortReject AS (
	SELECT
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCHL_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CLP_JOB_FAMILY_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_PARENT_CCL_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_ACCOUNT_NUMBER,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_ACTUAL_RATE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_BALLOON_PAY_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_BASIS_TYPE_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_INTEREST_RATE_MARGIN,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_LOAN_TERM_MTH_NUM,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CURRENT_LIMIT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_INC_DEC_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_POST_APP_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_NEW_PROD_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_INDEX_RATE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_INTEREST_ADV_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_INTERESTONLY_TERM_MTH_NUM,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CAPPED_TERM_MTH_NUM,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CAPPED_RATE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CRIS_PRODUCT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CCL_LOAN_PURPOSE_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_NEW_PROD_SUBTYPE_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_TEMP_EXCESS_MTHS,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_LOAN_PURPOSE_CLASS_CODE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CCL_INTEREST_RATE_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CRR,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_AD_TUC_INC_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CCL_RATE_TYPE_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_LINK_CCL_APP_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_LINK_CCL_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CHL_LMI_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_USED_IN_EXPOSURE_VIEW_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CCL_APP_BROKER_CIF_CODE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_APP_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_FIXED_INT_START_DATE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_CHILD_PDCT_LEVEL_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_PARENT_PDCT_LEVEL_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_PL_TARGET_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_REPAY_APPROX_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_REPAY_FREQUENCY_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_PL_APP_PROD_REPAY_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_PL_PROD_TERM_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_PL_CAMPAIGN_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_AD_HOC_CAMPAIGN_DESC,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_CAR_SEEKER_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_PL_PROD_TARGET_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_PL_MARKETING_SOURCE_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_HLS_ACCT_NO,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_TOTAL_INTEREST_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_APP_PROD_AMT,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_TP_BROKER_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_TP_BROKER_FIRST_NAME,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_TP_BROKER_LAST_NAME,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_TP_BROKER_GROUP_CAT_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.COM_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.COM_SUBTYPE_CODE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.COM_APP_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.COM_PRODUCT_TYPE_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.COM_SM_CASE_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.COM_FOUND_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CPL_FOUND_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CCL_FOUND_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CLP_FOUND_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CC_FOUND_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CC_APP_PROD_ID,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.ABN,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.BUSINESS_NAME,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.SIMPLE_APP_FLAG,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CHL_FOUND_FLAG,
		{{ ref('CpyRejtRejectOra') }}.APP_PROD_ID AS APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCHL_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_PARENT_CCL_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_ACCOUNT_NUMBER_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_ACTUAL_RATE_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_BALLOON_PAY_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_BASIS_TYPE_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_INTEREST_RATE_MARGIN_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_LOAN_TERM_MTH_NUM_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CURRENT_LIMIT_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_INC_DEC_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_POST_APP_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_NEW_PROD_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_INDEX_RATE_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_INTEREST_ADV_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_INTERESTONLY_TERM_MTH_NUM_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CAPPED_TERM_MTH_NUM_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CAPPED_RATE_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CRIS_PRODUCT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CCL_LOAN_PURPOSE_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_NEW_PROD_SUBTYPE_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_TEMP_EXCESS_MTHS_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_LOAN_PURPOSE_CLASS_CODE_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CCL_INTEREST_RATE_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CRR_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_AD_TUC_INC_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CCL_RATE_TYPE_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_LINK_CCL_APP_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_LINK_CCL_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CHL_LMI_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_USED_IN_EXPOSURE_VIEW_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CCL_APP_BROKER_CIF_CODE_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_APP_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_FIXED_INT_START_DATE_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_CHILD_PDCT_LEVEL_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_PARENT_PDCT_LEVEL_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_PL_TARGET_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_REPAY_APPROX_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_REPAY_FREQUENCY_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_PL_APP_PROD_REPAY_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_PL_PROD_TERM_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_PL_CAMPAIGN_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_AD_HOC_CAMPAIGN_DESC_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_CAR_SEEKER_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_PL_PROD_TARGET_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_PL_MARKETING_SOURCE_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_HLS_ACCT_NO_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_TOTAL_INTEREST_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_APP_PROD_AMT_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_TP_BROKER_ID_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_TP_BROKER_FIRST_NAME_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_TP_BROKER_LAST_NAME_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_TP_BROKER_GROUP_CAT_ID_R,
		{{ ref('CpyRejtRejectOra') }}.COM_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.COM_SUBTYPE_CODE_R,
		{{ ref('CpyRejtRejectOra') }}.COM_APP_ID_R,
		{{ ref('CpyRejtRejectOra') }}.COM_PRODUCT_TYPE_ID_R,
		{{ ref('CpyRejtRejectOra') }}.COM_SM_CASE_ID_R,
		{{ ref('CpyRejtRejectOra') }}.COM_FOUND_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CPL_FOUND_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CCL_FOUND_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CC_FOUND_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CC_APP_PROD_ID_R,
		{{ ref('CpyRejtRejectOra') }}.ABN_R,
		{{ ref('CpyRejtRejectOra') }}.BUSINESS_NAME_R,
		{{ ref('CpyRejtRejectOra') }}.SIMPLE_APP_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.CHL_FOUND_FLAG_R,
		{{ ref('CpyRejtRejectOra') }}.ORIG_ETL_D_R,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CHL_CR_DATE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CHL_ASSESSMENT_DATE,
		{{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.CHL_NCPR_FLAG,
		{{ ref('CpyRejtRejectOra') }}.CHL_CR_DATE_R,
		{{ ref('CpyRejtRejectOra') }}.CHL_ASSESSMENT_DATE_R,
		{{ ref('CpyRejtRejectOra') }}.CHL_NCPR_FLAG_R
	FROM {{ ref('XfmCheckNulls__OutCheckNullsSorted') }}
	OUTER JOIN {{ ref('CpyRejtRejectOra') }} ON {{ ref('XfmCheckNulls__OutCheckNullsSorted') }}.APP_PROD_ID = {{ ref('CpyRejtRejectOra') }}.APP_PROD_ID
)

SELECT * FROM JoinSrcSortReject