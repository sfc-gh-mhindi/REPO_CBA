{{ config(materialized='view', tags=['LdREJT_COM_PL_CCL_APP_PROD']) }}

WITH FunRejectsNulls AS (
	SELECT
		APP_PROD_ID as APP_PROD_ID,
		CCL_APP_PROD_ID as CCL_APP_PROD_ID,
		CCL_PARENT_CCL_APP_PROD_ID as CCL_PARENT_CCL_APP_PROD_ID,
		CCL_ACCOUNT_NUMBER as CCL_ACCOUNT_NUMBER,
		CCL_ACTUAL_RATE as CCL_ACTUAL_RATE,
		CCL_BALLOON_PAY_AMT as CCL_BALLOON_PAY_AMT,
		CCL_BASIS_TYPE_CAT_ID as CCL_BASIS_TYPE_CAT_ID,
		CCL_INTEREST_RATE_MARGIN as CCL_INTEREST_RATE_MARGIN,
		CCL_LOAN_TERM_MTH_NUM as CCL_LOAN_TERM_MTH_NUM,
		CCL_CURRENT_LIMIT as CCL_CURRENT_LIMIT,
		CCL_INC_DEC_AMT as CCL_INC_DEC_AMT,
		CCL_POST_APP_AMT as CCL_POST_APP_AMT,
		CCL_NEW_PROD_FLAG as CCL_NEW_PROD_FLAG,
		CCL_INDEX_RATE as CCL_INDEX_RATE,
		CCL_INTEREST_ADV_FLAG as CCL_INTEREST_ADV_FLAG,
		CCL_INTERESTONLY_TERM_MTH_NUM as CCL_INTERESTONLY_TERM_MTH_NUM,
		CCL_CAPPED_TERM_MTH_NUM as CCL_CAPPED_TERM_MTH_NUM,
		CCL_CAPPED_RATE as CCL_CAPPED_RATE,
		CCL_CRIS_PRODUCT_ID as CCL_CRIS_PRODUCT_ID,
		CCL_CCL_LOAN_PURPOSE_ID as CCL_CCL_LOAN_PURPOSE_ID,
		CCL_NEW_PROD_SUBTYPE_FLAG as CCL_NEW_PROD_SUBTYPE_FLAG,
		CCL_TEMP_EXCESS_MTHS as CCL_TEMP_EXCESS_MTHS,
		CCL_LOAN_PURPOSE_CLASS_CODE as CCL_LOAN_PURPOSE_CLASS_CODE,
		CCL_CCL_INTEREST_RATE_CAT_ID as CCL_CCL_INTEREST_RATE_CAT_ID,
		CCL_CRR as CCL_CRR,
		CCL_AD_TUC_INC_AMT as CCL_AD_TUC_INC_AMT,
		CCL_CCL_RATE_TYPE_CAT_ID as CCL_CCL_RATE_TYPE_CAT_ID,
		CCL_LINK_CCL_APP_ID as CCL_LINK_CCL_APP_ID,
		CCL_LINK_CCL_APP_PROD_ID as CCL_LINK_CCL_APP_PROD_ID,
		CCL_CHL_LMI_AMT as CCL_CHL_LMI_AMT,
		CCL_USED_IN_EXPOSURE_VIEW_FLAG as CCL_USED_IN_EXPOSURE_VIEW_FLAG,
		CCL_CCL_APP_BROKER_CIF_CODE as CCL_CCL_APP_BROKER_CIF_CODE,
		CCL_APP_ID as CCL_APP_ID,
		CCL_FIXED_INT_START_DATE as CCL_FIXED_INT_START_DATE,
		CCL_CHILD_PDCT_LEVEL_CAT_ID as CCL_CHILD_PDCT_LEVEL_CAT_ID,
		CCL_PARENT_PDCT_LEVEL_CAT_ID as CCL_PARENT_PDCT_LEVEL_CAT_ID,
		CPL_APP_PROD_ID as CPL_APP_PROD_ID,
		CPL_PL_TARGET_CAT_ID as CPL_PL_TARGET_CAT_ID,
		CPL_REPAY_APPROX_AMT as CPL_REPAY_APPROX_AMT,
		CPL_REPAY_FREQUENCY_ID as CPL_REPAY_FREQUENCY_ID,
		CPL_PL_APP_PROD_REPAY_CAT_ID as CPL_PL_APP_PROD_REPAY_CAT_ID,
		CPL_PL_PROD_TERM_CAT_ID as CPL_PL_PROD_TERM_CAT_ID,
		CPL_PL_CAMPAIGN_CAT_ID as CPL_PL_CAMPAIGN_CAT_ID,
		CPL_AD_HOC_CAMPAIGN_DESC as CPL_AD_HOC_CAMPAIGN_DESC,
		CPL_CAR_SEEKER_FLAG as CPL_CAR_SEEKER_FLAG,
		CPL_PL_PROD_TARGET_CAT_ID as CPL_PL_PROD_TARGET_CAT_ID,
		CPL_PL_MARKETING_SOURCE_CAT_ID as CPL_PL_MARKETING_SOURCE_CAT_ID,
		CPL_HLS_ACCT_NO as CPL_HLS_ACCT_NO,
		CPL_TOTAL_INTEREST_AMT as CPL_TOTAL_INTEREST_AMT,
		CPL_APP_PROD_AMT as CPL_APP_PROD_AMT,
		CPL_TP_BROKER_ID as CPL_TP_BROKER_ID,
		CPL_TP_BROKER_FIRST_NAME as CPL_TP_BROKER_FIRST_NAME,
		CPL_TP_BROKER_LAST_NAME as CPL_TP_BROKER_LAST_NAME,
		CPL_TP_BROKER_GROUP_CAT_ID as CPL_TP_BROKER_GROUP_CAT_ID,
		COM_APP_PROD_ID as COM_APP_PROD_ID,
		COM_SUBTYPE_CODE as COM_SUBTYPE_CODE,
		COM_APP_ID as COM_APP_ID,
		COM_PRODUCT_TYPE_ID as COM_PRODUCT_TYPE_ID,
		COM_SM_CASE_ID as COM_SM_CASE_ID,
		COM_FOUND_FLAG as COM_FOUND_FLAG,
		CPL_FOUND_FLAG as CPL_FOUND_FLAG,
		CCL_FOUND_FLAG as CCL_FOUND_FLAG,
		CC_FOUND_FLAG as CC_FOUND_FLAG,
		CC_APP_PROD_ID as CC_APP_PROD_ID,
		CCHL_APP_PROD_ID as CCHL_APP_PROD_ID,
		ABN as ABN,
		BUSINESS_NAME as BUSINESS_NAME,
		SIMPLE_APP_FLAG as SIMPLE_APP_FLAG,
		CHL_FOUND_FLAG as CHL_FOUND_FLAG,
		ETL_D as ETL_D,
		ORIG_ETL_D as ORIG_ETL_D,
		EROR_C as EROR_C
	FROM {{ ref('SrcIdNullsDS') }}
	UNION ALL
	SELECT
		APP_PROD_ID,
		CCL_APP_PROD_ID,
		CCL_PARENT_CCL_APP_PROD_ID,
		CCL_ACCOUNT_NUMBER,
		CCL_ACTUAL_RATE,
		CCL_BALLOON_PAY_AMT,
		CCL_BASIS_TYPE_CAT_ID,
		CCL_INTEREST_RATE_MARGIN,
		CCL_LOAN_TERM_MTH_NUM,
		CCL_CURRENT_LIMIT,
		CCL_INC_DEC_AMT,
		CCL_POST_APP_AMT,
		CCL_NEW_PROD_FLAG,
		CCL_INDEX_RATE,
		CCL_INTEREST_ADV_FLAG,
		CCL_INTERESTONLY_TERM_MTH_NUM,
		CCL_CAPPED_TERM_MTH_NUM,
		CCL_CAPPED_RATE,
		CCL_CRIS_PRODUCT_ID,
		CCL_CCL_LOAN_PURPOSE_ID,
		CCL_NEW_PROD_SUBTYPE_FLAG,
		CCL_TEMP_EXCESS_MTHS,
		CCL_LOAN_PURPOSE_CLASS_CODE,
		CCL_CCL_INTEREST_RATE_CAT_ID,
		CCL_CRR,
		CCL_AD_TUC_INC_AMT,
		CCL_CCL_RATE_TYPE_CAT_ID,
		CCL_LINK_CCL_APP_ID,
		CCL_LINK_CCL_APP_PROD_ID,
		CCL_CHL_LMI_AMT,
		CCL_USED_IN_EXPOSURE_VIEW_FLAG,
		CCL_CCL_APP_BROKER_CIF_CODE,
		CCL_APP_ID,
		CCL_FIXED_INT_START_DATE,
		CCL_CHILD_PDCT_LEVEL_CAT_ID,
		CCL_PARENT_PDCT_LEVEL_CAT_ID,
		CPL_APP_PROD_ID,
		CPL_PL_TARGET_CAT_ID,
		CPL_REPAY_APPROX_AMT,
		CPL_REPAY_FREQUENCY_ID,
		CPL_PL_APP_PROD_REPAY_CAT_ID,
		CPL_PL_PROD_TERM_CAT_ID,
		CPL_PL_CAMPAIGN_CAT_ID,
		CPL_AD_HOC_CAMPAIGN_DESC,
		CPL_CAR_SEEKER_FLAG,
		CPL_PL_PROD_TARGET_CAT_ID,
		CPL_PL_MARKETING_SOURCE_CAT_ID,
		CPL_HLS_ACCT_NO,
		CPL_TOTAL_INTEREST_AMT,
		CPL_APP_PROD_AMT,
		CPL_TP_BROKER_ID,
		CPL_TP_BROKER_FIRST_NAME,
		CPL_TP_BROKER_LAST_NAME,
		CPL_TP_BROKER_GROUP_CAT_ID,
		COM_APP_PROD_ID,
		COM_SUBTYPE_CODE,
		COM_APP_ID,
		COM_PRODUCT_TYPE_ID,
		COM_SM_CASE_ID,
		COM_FOUND_FLAG,
		CPL_FOUND_FLAG,
		CCL_FOUND_FLAG,
		CC_FOUND_FLAG,
		CC_APP_PROD_ID,
		CCHL_APP_PROD_ID,
		ABN,
		BUSINESS_NAME,
		SIMPLE_APP_FLAG,
		CHL_FOUND_FLAG,
		ETL_D,
		ORIG_ETL_D,
		EROR_C
	FROM {{ ref('SrcAppCclAppRejectsDS') }}
	UNION ALL
	SELECT
		APP_PROD_ID,
		CCL_APP_PROD_ID,
		CCL_PARENT_CCL_APP_PROD_ID,
		CCL_ACCOUNT_NUMBER,
		CCL_ACTUAL_RATE,
		CCL_BALLOON_PAY_AMT,
		CCL_BASIS_TYPE_CAT_ID,
		CCL_INTEREST_RATE_MARGIN,
		CCL_LOAN_TERM_MTH_NUM,
		CCL_CURRENT_LIMIT,
		CCL_INC_DEC_AMT,
		CCL_POST_APP_AMT,
		CCL_NEW_PROD_FLAG,
		CCL_INDEX_RATE,
		CCL_INTEREST_ADV_FLAG,
		CCL_INTERESTONLY_TERM_MTH_NUM,
		CCL_CAPPED_TERM_MTH_NUM,
		CCL_CAPPED_RATE,
		CCL_CRIS_PRODUCT_ID,
		CCL_CCL_LOAN_PURPOSE_ID,
		CCL_NEW_PROD_SUBTYPE_FLAG,
		CCL_TEMP_EXCESS_MTHS,
		CCL_LOAN_PURPOSE_CLASS_CODE,
		CCL_CCL_INTEREST_RATE_CAT_ID,
		CCL_CRR,
		CCL_AD_TUC_INC_AMT,
		CCL_CCL_RATE_TYPE_CAT_ID,
		CCL_LINK_CCL_APP_ID,
		CCL_LINK_CCL_APP_PROD_ID,
		CCL_CHL_LMI_AMT,
		CCL_USED_IN_EXPOSURE_VIEW_FLAG,
		CCL_CCL_APP_BROKER_CIF_CODE,
		CCL_APP_ID,
		CCL_FIXED_INT_START_DATE,
		CCL_CHILD_PDCT_LEVEL_CAT_ID,
		CCL_PARENT_PDCT_LEVEL_CAT_ID,
		CPL_APP_PROD_ID,
		CPL_PL_TARGET_CAT_ID,
		CPL_REPAY_APPROX_AMT,
		CPL_REPAY_FREQUENCY_ID,
		CPL_PL_APP_PROD_REPAY_CAT_ID,
		CPL_PL_PROD_TERM_CAT_ID,
		CPL_PL_CAMPAIGN_CAT_ID,
		CPL_AD_HOC_CAMPAIGN_DESC,
		CPL_CAR_SEEKER_FLAG,
		CPL_PL_PROD_TARGET_CAT_ID,
		CPL_PL_MARKETING_SOURCE_CAT_ID,
		CPL_HLS_ACCT_NO,
		CPL_TOTAL_INTEREST_AMT,
		CPL_APP_PROD_AMT,
		CPL_TP_BROKER_ID,
		CPL_TP_BROKER_FIRST_NAME,
		CPL_TP_BROKER_LAST_NAME,
		CPL_TP_BROKER_GROUP_CAT_ID,
		COM_APP_PROD_ID,
		COM_SUBTYPE_CODE,
		COM_APP_ID,
		COM_PRODUCT_TYPE_ID,
		COM_SM_CASE_ID,
		COM_FOUND_FLAG,
		CPL_FOUND_FLAG,
		CCL_FOUND_FLAG,
		CC_FOUND_FLAG,
		CC_APP_PROD_ID,
		CCHL_APP_PROD_ID,
		ABN,
		BUSINESS_NAME,
		SIMPLE_APP_FLAG,
		CHL_FOUND_FLAG,
		ETL_D,
		ORIG_ETL_D,
		EROR_C
	FROM {{ ref('SrcWorkRejectDS') }}
)

SELECT * FROM FunRejectsNulls