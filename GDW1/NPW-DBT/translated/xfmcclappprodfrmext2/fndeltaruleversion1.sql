{{ config(materialized='view', tags=['XfmCclAppProdFrmExt2']) }}

WITH FnDeltaRuleVersion1 AS (
	SELECT
		APPT_PDCT_I as APPT_PDCT_I,
		FEAT_I as FEAT_I,
		SRCE_SYST_APPT_FEAT_I as SRCE_SYST_APPT_FEAT_I,
		EFFT_D as EFFT_D,
		SRCE_SYST_C as SRCE_SYST_C,
		SRCE_SYST_APPT_OVRD_I as SRCE_SYST_APPT_OVRD_I,
		OVRD_FEAT_I as OVRD_FEAT_I,
		SRCE_SYST_STND_VALU_Q as SRCE_SYST_STND_VALU_Q,
		SRCE_SYST_STND_VALU_R as SRCE_SYST_STND_VALU_R,
		SRCE_SYST_STND_VALU_A as SRCE_SYST_STND_VALU_A,
		CNCY_C as CNCY_C,
		ACTL_VALU_Q as ACTL_VALU_Q,
		ACTL_VALU_R as ACTL_VALU_R,
		ACTL_VALU_A as ACTL_VALU_A,
		FEAT_SEQN_N as FEAT_SEQN_N,
		FEAT_STRT_D as FEAT_STRT_D,
		FEE_CHRG_D as FEE_CHRG_D,
		OVRD_REAS_C as OVRD_REAS_C,
		FEE_ADD_TO_TOTL_F as FEE_ADD_TO_TOTL_F,
		FEE_CAPL_F as FEE_CAPL_F,
		EXPY_D as EXPY_D,
		PROS_KEY_EFFT_I as PROS_KEY_EFFT_I,
		PROS_KEY_EXPY_I as PROS_KEY_EXPY_I,
		EROR_SEQN_I as EROR_SEQN_I,
		RUN_STRM as RUN_STRM,
		DLTA_VERS as DLTA_VERS,
		FEAT_TYPE_C as FEAT_TYPE_C
	FROM {{ ref('XfmBusinessRules__ApptPdctFeat2') }}
	UNION ALL
	SELECT
		APPT_PDCT_I,
		FEAT_I,
		SRCE_SYST_APPT_FEAT_I,
		EFFT_D,
		SRCE_SYST_C,
		SRCE_SYST_APPT_OVRD_I,
		OVRD_FEAT_I,
		SRCE_SYST_STND_VALU_Q,
		SRCE_SYST_STND_VALU_R,
		SRCE_SYST_STND_VALU_A,
		CNCY_C,
		ACTL_VALU_Q,
		ACTL_VALU_R,
		ACTL_VALU_A,
		FEAT_SEQN_N,
		FEAT_STRT_D,
		FEE_CHRG_D,
		OVRD_REAS_C,
		FEE_ADD_TO_TOTL_F,
		FEE_CAPL_F,
		EXPY_D,
		PROS_KEY_EFFT_I,
		PROS_KEY_EXPY_I,
		EROR_SEQN_I,
		RUN_STRM,
		DLTA_VERS,
		FEAT_TYPE_C
	FROM {{ ref('XfmBusinessRules__ApptPdctFeat3') }}
	UNION ALL
	SELECT
		APPT_PDCT_I,
		FEAT_I,
		SRCE_SYST_APPT_FEAT_I,
		EFFT_D,
		SRCE_SYST_C,
		SRCE_SYST_APPT_OVRD_I,
		OVRD_FEAT_I,
		SRCE_SYST_STND_VALU_Q,
		SRCE_SYST_STND_VALU_R,
		SRCE_SYST_STND_VALU_A,
		CNCY_C,
		ACTL_VALU_Q,
		ACTL_VALU_R,
		ACTL_VALU_A,
		FEAT_SEQN_N,
		FEAT_STRT_D,
		FEE_CHRG_D,
		OVRD_REAS_C,
		FEE_ADD_TO_TOTL_F,
		FEE_CAPL_F,
		EXPY_D,
		PROS_KEY_EFFT_I,
		PROS_KEY_EXPY_I,
		EROR_SEQN_I,
		RUN_STRM,
		DLTA_VERS,
		FEAT_TYPE_C
	FROM {{ ref('XfmBusinessRules__ApptPdctFeat5') }}
)

SELECT * FROM FnDeltaRuleVersion1